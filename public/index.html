<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SunnyYummy 網頁 (Node.js)</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <h1> ～SunnyYummy～ </h1>
        <!-- 未來可以在這裡放導覽列 -->
    </header>

    <main class="container">
        <p class="api-links"> <!-- 給 API 連結加上 class -->
            <a href="/api/hello">測試後端 API</a> |
            <a href="/api/db-time">測試資料庫時間</a> |
            <a href="/api/products">查看商品 API</a>
        </p>

        <hr>

        <h2>商品列表</h2>
        <div id="product-list">
            <p>正在載入商品...</p>
        </div>

        <hr>

    </main> <!-- 主要內容結束 -->

    <footer>
        <div class="container">
            <p>© 2025 SunnyYummy. All Rights Reserved.</p>
            <!-- 可以放社群連結等 -->
        </div>
    </footer>

    <!-- JavaScript 程式碼放在 body 結束前 -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log("頁面載入完成，準備獲取商品...");
        const productListDiv = document.getElementById('product-list');

        fetch('/api/products')
            .then(response => {
                if (!response.ok) {
                    throw new Error('無法獲取商品資料，狀態碼：' + response.status);
                }
                return response.json();
            })
            .then(products => {
                console.log("成功獲取商品資料:", products);
                productListDiv.innerHTML = '';

                if (products.length === 0) {
                    productListDiv.innerHTML = '<p>目前沒有商品。</p>';
                    return;
                }

                products.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card';

                    const img = document.createElement('img');
                    img.src = product.image_url;
                    img.alt = product.name;

                    const nameHeading = document.createElement('h3');
                    nameHeading.textContent = product.name;

                    const descriptionP = document.createElement('p');
                    descriptionP.textContent = product.description;

                    // --- 修改這裡：給價格加上 class="price" ---
                    const priceP = document.createElement('p');
                    priceP.className = 'price'; // <--- 加上這行
                    priceP.textContent = `價格: $${product.price}`;
                    // --- 修改結束 ---

                    // --- 修改這裡：給連結加上 class="button" ---
                    const link = document.createElement('a');
                    link.className = 'button'; // <--- 加上這行
                    link.href = product.seven_eleven_url;
                    link.textContent = '前往 7-11 賣貨便預購';
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                    // --- 修改結束 ---

                    card.appendChild(img);
                    card.appendChild(nameHeading);
                    card.appendChild(descriptionP);
                    card.appendChild(priceP);
                    card.appendChild(link);

                    productListDiv.appendChild(card);
                });
            })
            .catch(error => {
                console.error("獲取商品時發生錯誤:", error);
                productListDiv.innerHTML = `<p>載入商品失敗：${error.message}</p>`;
            });
    });
    </script>

</body>
</html>