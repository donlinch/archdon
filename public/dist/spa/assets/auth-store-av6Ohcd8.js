import{a as u,ba as h,r}from"./index-DYK3U5_v.js";function b(){const s=u(()=>!1),o=u(()=>s.value?"http://localhost:3000":"");return{resolveUrl:(e,t="https://cdn.quasar.dev/img/boy-avatar.png")=>!e||typeof e!="string"||e.trim()===""?t:e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?`${o.value}${e}`:t}}const x=h("auth",()=>{const{resolveUrl:s}=b(),o=r(null),n=r(null),e=r("未登入"),t=r(s(null)),v=r(!1),l=r(null),i=u(()=>!!o.value&&!!n.value);function d(){console.log("Initializing authentication state from localStorage...");const a=localStorage.getItem("boxCurrentUserId");if(a){const g=localStorage.getItem(`boxUserToken_${a}`),m=localStorage.getItem("boxCurrentUsername"),I=localStorage.getItem("boxCurrentDisplayName")||m,S=localStorage.getItem("boxCurrentUserAvatar"),f=localStorage.getItem("boxCurrentUserRoleName");g&&m?(o.value=g,n.value=a,e.value=I,l.value=f,t.value=s(S),console.log(`AuthStore: User ${e.value} is logged in. Avatar URL set to: ${t.value}`)):(console.log("AuthStore: Token not found, clearing stale auth data."),c())}else console.log("AuthStore: No user ID found in localStorage.")}function c(){console.log("AuthStore: Logging out and clearing auth state.");const a=localStorage.getItem("boxCurrentUserId");a&&localStorage.removeItem(`boxUserToken_${a}`),localStorage.removeItem("boxCurrentUserId"),localStorage.removeItem("boxCurrentUserAvatar"),localStorage.removeItem("boxCurrentUsername"),localStorage.removeItem("boxCurrentDisplayName"),localStorage.removeItem("boxCurrentUserRoleName"),o.value=null,n.value=null,e.value="未登入",t.value=s(null),l.value=null}return{token:o,userId:n,username:e,avatar:t,isDev:v,roleName:l,isLoggedIn:i,initializeAuth:d,logout:c}});export{b as a,x as u};
