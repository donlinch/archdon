import{r as E,t as I,o as we,m as be,x as _e,y as D,z as ke,C as v,E as X,D as ie,B as ne,G as Oe,J as oe,K as re,F as Y,I as Se,Q as Pe}from"./index-D4w5BbQ9.js";import{Q as Te}from"./QPage-BVDU7mQx.js";import{u as Ee,P as ze}from"./PetDisplay-CYTkIUUN.js";import A from"./Basic Charakter Spritesheet-face-DGcq_MBM.js";import Ce from"./Basic Charakter Spritesheet-left-CGJoGvDD.js";import Me from"./Basic Charakter Spritesheet-righ-BUuq8Otu.js";import Ie from"./Basic Charakter Spritesheet-back-B9rVEyHH.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $=(t,e)=>{const i=e.x-t.x,o=e.y-t.y;return Math.sqrt(i*i+o*o)},Ae=(t,e)=>{const i=e.x-t.x,o=e.y-t.y;return He(Math.atan2(o,i))},Ne=(t,e,i)=>{const o={x:0,y:0};return i=K(i),o.x=t.x-e*Math.cos(i),o.y=t.y-e*Math.sin(i),o},K=t=>t*(Math.PI/180),He=t=>t*(180/Math.PI),Le=t=>isNaN(t.buttons)?t.pressure!==0:t.buttons!==0,V=new Map,se=t=>{V.has(t)&&clearTimeout(V.get(t)),V.set(t,setTimeout(t,100))},R=(t,e,i)=>{const o=e.split(/[ ,]+/g);let n;for(let r=0;r<o.length;r+=1)n=o[r],t.addEventListener?t.addEventListener(n,i,!1):t.attachEvent&&t.attachEvent(n,i)},ae=(t,e,i)=>{const o=e.split(/[ ,]+/g);let n;for(let r=0;r<o.length;r+=1)n=o[r],t.removeEventListener?t.removeEventListener(n,i):t.detachEvent&&t.detachEvent(n,i)},ue=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),le=()=>{const t=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:e}},ce=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},Z=(t,e,i)=>{const o=he(t);for(let n in o)if(o.hasOwnProperty(n))if(typeof e=="string")o[n]=e+" "+i;else{let r="";for(let c=0,s=e.length;c<s;c+=1)r+=e[c]+" "+i+", ";o[n]=r.slice(0,-2)}return o},Fe=(t,e)=>{const i=he(t);for(let o in i)i.hasOwnProperty(o)&&(i[o]=e);return i},he=t=>{const e={};return e[t]="",["webkit","Moz","o"].forEach(function(o){e[o+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},G=(t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},Xe=(t,e)=>{const i={};for(let o in t)t.hasOwnProperty(o)&&e.hasOwnProperty(o)?i[o]=e[o]:t.hasOwnProperty(o)&&(i[o]=t[o]);return i},Q=(t,e)=>{if(t.length)for(let i=0,o=t.length;i<o;i+=1)e(t[i]);else e(t)},Ye=(t,e,i)=>({x:Math.min(Math.max(t.x,e.x-i),e.x+i),y:Math.min(Math.max(t.y,e.y-i),e.y+i)});var $e="ontouchstart"in window,Re=!!window.PointerEvent,Be=!!window.MSPointerEvent,N={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},z,H={};Re?z=N.pointer:Be?z=N.MSPointer:$e?(z=N.touch,H=N.mouse):z=N.mouse;function S(){}S.prototype.on=function(t,e){var i=this,o=t.split(/[ ,]+/g),n;i._handlers_=i._handlers_||{};for(var r=0;r<o.length;r+=1)n=o[r],i._handlers_[n]=i._handlers_[n]||[],i._handlers_[n].push(e);return i};S.prototype.off=function(t,e){var i=this;return i._handlers_=i._handlers_||{},t===void 0?i._handlers_={}:e===void 0?i._handlers_[t]=null:i._handlers_[t]&&i._handlers_[t].indexOf(e)>=0&&i._handlers_[t].splice(i._handlers_[t].indexOf(e),1),i};S.prototype.trigger=function(t,e){var i=this,o=t.split(/[ ,]+/g),n;i._handlers_=i._handlers_||{};for(var r=0;r<o.length;r+=1)n=o[r],i._handlers_[n]&&i._handlers_[n].length&&i._handlers_[n].forEach(function(c){c.call(i,{type:n,target:i},e)})};S.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=Xe(e.options,t))};S.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){typeof i["on"+e]=="function"?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},R(t,z[e],i._domHandlers_[e]),H[e]&&R(t,H[e],i._domHandlers_[e]),i};S.prototype.unbindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},ae(t,z[e],i._domHandlers_[e]),H[e]&&ae(t,H[e],i._domHandlers_[e]),delete i._domHandlers_[e],this};function m(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=m.id,m.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}m.prototype=new S;m.constructor=m;m.id=0;m.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};m.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=Fe("borderRadius","50%"),i=Z("transition","opacity",t),o={};return o.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},o.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},o.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},G(o.el,i),this.options.shape==="circle"&&G(o.back,e),G(o.front,e),this.applyStyles(o),this};m.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this};m.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};m.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};m.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};m.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e};m.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=i,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const i=e.options.restJoystick,o={};o.x=i===!0||i.x!==!1?0:e.instance.frontPosition.x,o.y=i===!0||i.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,o)}return e};m.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var o=i.options.fadeTime+"ms",n={};n.front=Z("transition",["transform"],o);var r={front:{}};r.front={transform:"translate("+i.frontPosition.x+"px,"+i.frontPosition.y+"px)"},i.applyStyles(n),i.applyStyles(r),i.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(i),i.restCallback()},i.options.fadeTime)};m.prototype.restCallback=function(){var t=this,e={};e.front=Z("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)};m.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};m.prototype.computeDirection=function(t){var e=t.angle.radian,i=Math.PI/4,o=Math.PI/2,n,r,c;if(e>i&&e<i*3&&!t.lockX?n="up":e>-i&&e<=i&&!t.lockY?n="left":e>-i*3&&e<=-i&&!t.lockX?n="down":t.lockY||(n="right"),t.lockY||(e>-o&&e<o?r="left":r="right"),t.lockX||(e>0?c="up":c="down"),t.force>this.options.threshold){var s={},a;for(a in this.direction)this.direction.hasOwnProperty(a)&&(s[a]=this.direction[a]);var d={};this.direction={x:r,y:c,angle:n},t.direction=this.direction;for(a in s)s[a]===this.direction[a]&&(d[a]=!0);if(d.x&&d.y&&d.angle)return t;(!d.x||!d.y)&&this.trigger("plain",t),d.x||this.trigger("plain:"+r,t),d.y||this.trigger("plain:"+c,t),d.angle||this.trigger("dir dir:"+n,t)}else this.resetDirection();return t};function h(t,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=t,i.id=h.id,h.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);const o=getComputedStyle(i.options.zone.parentElement);return o&&o.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}h.prototype=new S;h.constructor=h;h.id=0;h.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(i){if(i===void 0)return e[0];for(var o=0,n=e.length;o<n;o+=1)if(e[o].identifier===i)return e[o];return!1}};h.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"};h.prototype.begin=function(){var t=this,e=t.options;if(e.mode==="static"){var i=t.createNipple(e.position,t.manager.getIdentifier());i.add(),t.idles.push(i)}};h.prototype.createNipple=function(t,e){var i=this,o=i.manager.scroll,n={},r=i.options,c={x:i.parentIsFlex?o.x:o.x+i.box.left,y:i.parentIsFlex?o.y:o.y+i.box.top};if(t.x&&t.y)n={x:t.x-c.x,y:t.y-c.y};else if(t.top||t.right||t.bottom||t.left){var s=document.createElement("DIV");s.style.display="hidden",s.style.top=t.top,s.style.right=t.right,s.style.bottom=t.bottom,s.style.left=t.left,s.style.position="absolute",r.zone.appendChild(s);var a=s.getBoundingClientRect();r.zone.removeChild(s),n=t,t={x:a.left+o.x,y:a.top+o.y}}var d=new m(i,{color:r.color,size:r.size,threshold:r.threshold,fadeTime:r.fadeTime,dataOnly:r.dataOnly,restJoystick:r.restJoystick,restOpacity:r.restOpacity,mode:r.mode,identifier:e,position:t,zone:r.zone,frontPosition:{x:0,y:0},shape:r.shape});return r.dataOnly||(ce(d.ui.el,n),ce(d.ui.front,d.frontPosition)),i.nipples.push(d),i.trigger("added "+d.identifier+":added",d),i.manager.trigger("added "+d.identifier+":added",d),i.bindNipple(d),d};h.prototype.updateBox=function(){var t=this;t.box=t.options.zone.getBoundingClientRect()};h.prototype.bindNipple=function(t){var e=this,i,o=function(n,r){i=n.type+" "+r.id+":"+n.type,e.trigger(i,r)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",o),t.on("dir:up dir:right dir:down dir:left",o),t.on("plain:up plain:right plain:down plain:left",o)};h.prototype.pressureFn=function(t,e,i){var o=this,n=0;clearInterval(o.pressureIntervals[i]),o.pressureIntervals[i]=setInterval((function(){var r=t.force||t.pressure||t.webkitForce||0;r!==n&&(e.trigger("pressure",r),o.trigger("pressure "+e.identifier+":pressure",r),n=r)}).bind(o),100)};h.prototype.onstart=function(t){var e=this,i=e.options,o=t;t=ue(t),e.updateBox();var n=function(r){e.actives.length<i.maxNumberOfNipples?e.processOnStart(r):o.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(c){if(Object.values(o.touches).findIndex(function(a){return a.identifier===c})<0){var s=[t[0]];s.identifier=c,e.processOnEnd(s)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(r))};return Q(t,n),e.manager.bindDocument(),!1};h.prototype.processOnStart=function(t){var e=this,i=e.options,o,n=e.manager.getIdentifier(t),r=t.force||t.pressure||t.webkitForce||0,c={x:t.pageX,y:t.pageY},s=e.getOrCreate(n,c);s.identifier!==n&&e.manager.removeIdentifier(s.identifier),s.identifier=n;var a=function(u){u.trigger("start",u),e.trigger("start "+u.id+":start",u),u.show(),r>0&&e.pressureFn(t,u,u.identifier),e.processOnMove(t)};if((o=e.idles.indexOf(s))>=0&&e.idles.splice(o,1),e.actives.push(s),e.ids.push(s.identifier),i.mode!=="semi")a(s);else{var d=$(c,s.position);if(d<=i.catchDistance)a(s);else{s.destroy(),e.processOnStart(t);return}}return s};h.prototype.getOrCreate=function(t,e){var i=this,o=i.options,n;return/(semi|static)/.test(o.mode)?(n=i.idles[0],n?(i.idles.splice(0,1),n):o.mode==="semi"?i.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1)):(n=i.createNipple(e,t),n)};h.prototype.processOnMove=function(t){var e=this,i=e.options,o=e.manager.getIdentifier(t),n=e.nipples.get(o),r=e.manager.scroll;if(!Le(t)){this.processOnEnd(t);return}if(!n){console.error("Found zombie joystick with ID "+o),e.manager.removeIdentifier(o);return}if(i.dynamicPage){var c=n.el.getBoundingClientRect();n.position={x:r.x+c.left,y:r.y+c.top}}n.identifier=o;var s=n.options.size/2,a={x:t.pageX,y:t.pageY};i.lockX&&(a.y=n.position.y),i.lockY&&(a.x=n.position.x);var d=$(a,n.position),u=Ae(a,n.position),w=K(u),g=d/s,b={distance:d,position:a},T,P;if(n.options.shape==="circle"?(T=Math.min(d,s),P=Ne(n.position,T,u)):(P=Ye(a,n.position,s),T=$(P,n.position)),i.follow){if(d>s){let L=a.x-P.x,x=a.y-P.y;n.position.x+=L,n.position.y+=x,n.el.style.top=n.position.y-(e.box.top+r.y)+"px",n.el.style.left=n.position.x-(e.box.left+r.x)+"px",d=$(a,n.position)}}else a=P,d=T;var C=a.x-n.position.x,M=a.y-n.position.y;n.frontPosition={x:C,y:M},i.dataOnly||(n.ui.front.style.transform="translate("+C+"px,"+M+"px)");var O={identifier:n.identifier,position:a,force:g,pressure:t.force||t.pressure||t.webkitForce||0,distance:d,angle:{radian:w,degree:u},vector:{x:C/s,y:-M/s},raw:b,instance:n,lockX:i.lockX,lockY:i.lockY};O=n.computeDirection(O),O.angle={radian:K(180-u),degree:180-u},n.trigger("move",O),e.trigger("move "+n.id+":move",O)};h.prototype.processOnEnd=function(t){var e=this,i=e.options,o=e.manager.getIdentifier(t),n=e.nipples.get(o),r=e.manager.removeIdentifier(n.identifier);n&&(i.dataOnly||n.hide(function(){i.mode==="dynamic"&&(n.trigger("removed",n),e.trigger("removed "+n.id+":removed",n),e.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(e.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),e.trigger("end "+n.id+":end",n),e.ids.indexOf(n.identifier)>=0&&e.ids.splice(e.ids.indexOf(n.identifier),1),e.actives.indexOf(n)>=0&&e.actives.splice(e.actives.indexOf(n),1),/(semi|static)/.test(i.mode)?e.idles.push(n):e.nipples.indexOf(n)>=0&&e.nipples.splice(e.nipples.indexOf(n),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[r.id]=r.identifier))};h.prototype.onDestroyed=function(t,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()};h.prototype.destroy=function(){var t=this;t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(i){i.destroy()});for(var e in t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()};function y(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=le(),e.config(t),e.prepareCollections();var i=function(){var n;e.collections.forEach(function(r){r.forEach(function(c){n=c.el.getBoundingClientRect(),c.position={x:e.scroll.x+n.left,y:e.scroll.y+n.top}})})};R(window,"resize",function(){se(i)});var o=function(){e.scroll=le()};return R(window,"scroll",function(){se(o)}),e.collections}y.prototype=new S;y.constructor=y;y.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(o){return i=o.get(e),!i}),i}};y.prototype.create=function(t){return this.createCollection(t)};y.prototype.createCollection=function(t){var e=this,i=new h(e,t);return e.bindCollection(i),e.collections.push(i),i};y.prototype.bindCollection=function(t){var e=this,i,o=function(n,r){i=n.type+" "+r.id+":"+n.type,e.trigger(i,r)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",o),t.on("dir:up dir:right dir:down dir:left",o),t.on("plain:up plain:right plain:down plain:left",o)};y.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)};y.prototype.unbindDocument=function(t){var e=this;(!Object.keys(e.ids).length||t===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};y.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};y.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e};y.prototype.onmove=function(t){var e=this;return e.onAny("move",t),!1};y.prototype.onend=function(t){var e=this;return e.onAny("end",t),!1};y.prototype.oncancel=function(t){var e=this;return e.onAny("end",t),!1};y.prototype.onAny=function(t,e){var i=this,o,n="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=ue(e);var r=function(s,a,d){d.ids.indexOf(a)>=0&&(d[n](s),s._found_=!0)},c=function(s){o=i.getIdentifier(s),Q(i.collections,r.bind(null,s,o)),s._found_||i.removeIdentifier(o)};return Q(e,c),!1};y.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(e){e.destroy()}),t.off()};y.prototype.onDestroyed=function(t,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};const de=new y,qe={create:function(t){return de.create(t)},factory:de},Ue={key:0,class:"speech-bubble"},We={key:0,class:"mobile-controls-container q-mt-md"},Je={class:"action-button-zone"},Ve={class:"minimap-container q-mt-md"},Ge={class:"minimap-world"},fe=1e3,pe=1e3,k=.2,Ke=Object.assign({name:"CameraTestPage"},{__name:"CameraTestPage",setup(t){const e=Ee(),i=E(null),o=E(null),n=E(null),r=E(null),c=I({x:0,y:0,zoom:1}),s=I({x:150,y:150}),a=I({baseSpeed:.2,currentSpeed:.3,maxSpeed:1.5,acceleration:.2,direction:null}),d=E(!1);let u=null;const w=E(A),g=I({ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1}),b=I({visible:!1,message:"",timer:null});function T(l){const p=[{x:50,y:50},{x:250,y:100},{x:400,y:200},{x:100,y:300},{x:300,y:350}][l-1]||{x:0,y:0};return{left:`${p.x}px`,top:`${p.y}px`}}function P(l){const p=[{x:50,y:50},{x:250,y:100},{x:400,y:200},{x:100,y:300},{x:300,y:350}][l-1]||{x:0,y:0};return{left:`${p.x*k}px`,top:`${p.y*k}px`}}function C(){return{left:`${s.x*k}px`,top:`${s.y*k}px`}}function M(){if(!i.value)return{};const l=i.value.clientWidth,f=i.value.clientHeight,p=s.x,_=s.y,q=(p-l/2)*k,U=(_-f/2)*k,W=l*k/c.zoom,J=f*k/c.zoom;return{left:`${q}px`,top:`${U}px`,width:`${W}px`,height:`${J}px`}}function O(l){const f=l.currentTarget.getBoundingClientRect(),p=(l.clientX-f.left)/k,_=(l.clientY-f.top)/k;L(p,_),B()}function L(l,f){s.x=Math.max(0,Math.min(fe,l)),s.y=Math.max(0,Math.min(pe,f))}function x(l){switch(a.direction=l,l){case"left":w.value=Ce;break;case"right":w.value=Me;break;case"up":w.value=Ie;break;case"down":w.value=A;break}d.value||(d.value=!0,me())}function j(){if(a.direction){a.currentSpeed=Math.min(a.maxSpeed,a.currentSpeed+a.acceleration);let l=s.x,f=s.y;switch(a.direction){case"left":l-=a.currentSpeed;break;case"right":l+=a.currentSpeed;break;case"up":f-=a.currentSpeed;break;case"down":f+=a.currentSpeed;break}L(l,f),B()}else{a.currentSpeed=a.baseSpeed,d.value=!1;return}u=requestAnimationFrame(j)}function me(){u&&cancelAnimationFrame(u),u=requestAnimationFrame(j)}function F(){u&&(cancelAnimationFrame(u),u=null),d.value=!1,a.currentSpeed=a.baseSpeed}function ee(l){if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(l.key))switch(g[l.key]=!0,l.key){case"ArrowLeft":x("left");break;case"ArrowRight":x("right");break;case"ArrowUp":x("up");break;case"ArrowDown":x("down");break}}function te(l){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(l.key)&&(g[l.key]=!1),Object.values(g).some(p=>p)?g.ArrowLeft?x("left"):g.ArrowRight?x("right"):g.ArrowUp?x("up"):g.ArrowDown&&x("down"):(a.direction=null,w.value=A,F())}function B(){if(!i.value)return;const l=i.value.clientWidth,f=i.value.clientHeight;let p=-s.x+l/2,_=-s.y+f/2;const q=0,U=0,W=l-fe,J=f-pe;p=Math.min(q,Math.max(W*c.zoom,p)),_=Math.min(U,Math.max(J*c.zoom,_)),c.x=p,c.y=_,ve()}function ye(){c.zoom=1,s.x=150,s.y=150,w.value=A,a.direction=null,a.currentSpeed=a.baseSpeed,F(),Object.keys(g).forEach(l=>{g[l]=!1}),B()}function ve(){n.value&&(n.value.style.transform=`translate(${c.x}px, ${c.y}px) scale(${c.zoom})`,r.value&&(r.value.style.left=`${s.x}px`,r.value.style.top=`${s.y}px`))}function ge(){b.message="HI",b.visible=!0,b.timer&&clearTimeout(b.timer),b.timer=setTimeout(()=>{b.visible=!1},2e3)}function xe(){const l={zone:o.value,mode:"static",position:{left:"50%",top:"50%"},color:"blue",size:100},f=qe.create(l);f.on("move",(p,_)=>{_.direction&&x(_.direction.angle)}),f.on("end",()=>{a.direction=null,w.value=A,F()})}return we(()=>{ye(),window.addEventListener("keydown",ee),window.addEventListener("keyup",te),e.platform.is.mobile&&xe();const l=document.querySelector(".minimap-world");l&&l.addEventListener("click",O)}),be(()=>{window.removeEventListener("keydown",ee),window.removeEventListener("keyup",te),F();const l=document.querySelector(".minimap-world");l&&l.removeEventListener("click",O)}),(l,f)=>(D(),_e(Te,{class:"flex flex-center column"},{default:ke(()=>[v("div",{class:"camera-test-container q-mt-lg",ref_key:"cameraContainer",ref:i},[v("div",{class:"game-world",ref_key:"gameWorld",ref:n},[v("div",{class:"player",ref_key:"player",ref:r},[b.visible?(D(),X("div",Ue,Oe(b.message),1)):ie("",!0),ne(ze,{spriteSheet:w.value,frameWidth:48,frameHeight:38,totalFrames:4,animationDuration:"1s",scale:2},null,8,["spriteSheet"])],512),(D(),X(oe,null,re(5,p=>v("div",{class:"obstacle",key:p,style:Y(T(p))},null,4)),64))],512)],512),Se(e).platform.is.mobile?(D(),X("div",We,[v("div",{ref_key:"joystickZone",ref:o,class:"joystick-zone"},null,512),v("div",Je,[ne(Pe,{round:"",color:"red",icon:"campaign",onClick:ge,size:"lg",push:""})])])):ie("",!0),v("div",Ve,[v("div",{class:"minimap",onClick:O},[v("div",Ge,[(D(),X(oe,null,re(5,p=>v("div",{class:"minimap-obstacle",key:p,style:Y(P(p))},null,4)),64)),v("div",{class:"minimap-player",style:Y(C())},null,4),v("div",{class:"viewport-rect",style:Y(M())},null,4)])]),f[0]||(f[0]=v("p",{class:"text-caption text-grey-8 q-mt-xs"},"地圖全貌 (點擊可移動角色)",-1))])]),_:1}))}}),rt=De(Ke,[["__scopeId","data-v-fcbfa70a"]]);export{rt as default};
