import{r,a as A,D as I,m as Ce,A as Ae,$ as G,_ as i,a1 as Ie,a2 as n,Z as d,a7 as q,aa as k,a3 as m,W as h,Q as J,a8 as R,aj as V,ab as F,ac as W,a0 as qe,aq as ze}from"./index---0Ru15f.js";import{Q as De}from"./QPage-ClzyyhNB.js";import{u as Pe}from"./use-quasar-CyfJr-rY.js";import{n as Te}from"./index-J1xnI5EH.js";import{P as Le}from"./PetDisplay-Bp0exty4.js";import z from"./Basic Charakter Spritesheet-face-DGcq_MBM.js";import Re from"./Basic Charakter Spritesheet-left-CGJoGvDD.js";import Fe from"./Basic Charakter Spritesheet-righ-BUuq8Otu.js";import We from"./Basic Charakter Spritesheet-back-B9rVEyHH.js";import He from"./background-BPEpjkck.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Oe={class:"dev-button-container"},Be={class:"game-stats-container"},Ee={class:"score-container"},Ue={key:0,class:"speech-bubble"},Qe={key:0,class:"mobile-controls-container q-mt-md"},Xe={class:"action-button-zone"},Ye={class:"minimap-container q-mt-md"},Ke={class:"inventory-container"},Ne=["onClick"],Ge={class:"minimap-world"},Je={key:0,class:"separator"},Ve={key:1,class:"right-area"},Ze={class:"dev-controls"},et={class:"row q-col-gutter-sm"},tt={class:"col-12"},ot={class:"col-12"},nt={class:"row q-col-gutter-sm"},at={class:"col-12"},lt={class:"col-12"},st={class:"map-planning-area q-mt-md"},rt={class:"row q-col-gutter-sm q-mb-sm"},it={class:"col-6"},ct={class:"col-6"},ut={class:"row q-col-gutter-sm q-mb-sm"},dt={class:"col-12"},mt={class:"map-planning-container"},vt=["onClick","title"],pt={class:"obstacle-number"},Z=1e3,ee=1e3,b=.2,ft=Object.assign({name:"FoodRunningPage"},{__name:"FoodRunningPage",setup(ht){const y=r(!0),te=A(()=>({width:y.value?"350px":"100%",flex:y.value?"none":"1",backgroundImage:`url(${He})`,backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:(y.value,"flex-start")})),oe=A(()=>({width:"330px",margin:"0 auto"}));function ne(){y.value=!y.value}const D=Pe(),x=r(null),U=r(null),H=r(null),P=r(null),c=I({x:0,y:0,zoom:1}),u=I({x:150,y:150}),l=I({baseSpeed:.2,currentSpeed:.3,maxSpeed:1.5,acceleration:.2,direction:null}),T=r(!1);let S=null;const C=r(180),v=r(null),j=r(0);function ae(e=1){j.value+=e}function le(){j.value=0}const se=A(()=>{const e=Math.floor(C.value/60),o=C.value%60;return`${e}:${o.toString().padStart(2,"0")}`});function Q(){v.value||(v.value=setInterval(()=>{C.value>0?C.value--:(clearInterval(v.value),v.value=null,console.log("Time is up!"))},1e3))}function re(){v.value&&(clearInterval(v.value),v.value=null),C.value=180,le(),Q()}const g=r(z),p=I({ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1}),_=I({visible:!1,message:"",timer:null}),s=r([null,{icon:"restaurant",name:"料理1"},{icon:"local_pizza",name:"料理2"},null,{icon:"cake",name:"料理3"},null]),$=r(-1);function ie(e){$.value===e?$.value=-1:($.value=e,s.value[e]&&console.log(`選擇了道具: ${s.value[e].name}`))}function ce(e,o=-1){if(o>=0&&o<s.value.length)return s.value[o]=e,!0;for(let t=0;t<s.value.length;t++)if(!s.value[t])return s.value[t]=e,!0;return!1}function ue(e){return e>=0&&e<s.value.length?(s.value[e]=null,$.value===e&&($.value=-1),!0):!1}const de=A(()=>{if(!x.value)return{};const e=x.value.clientWidth,o=x.value.clientHeight,t=-c.x,a=-c.y,M=t*b,O=a*b,B=e/c.zoom*b,E=o/c.zoom*b;return{left:`${M}px`,top:`${O}px`,width:`${B}px`,height:`${E}px`}}),me=A(()=>({left:`${u.x*b}px`,top:`${u.y*b}px`})),ve=A(()=>({width:"180px",height:"180px"}));function pe(e,o){u.x=Math.max(0,Math.min(Z,e)),u.y=Math.max(0,Math.min(ee,o))}function f(e){switch(l.direction=e,e){case"left":g.value=Re;break;case"right":g.value=Fe;break;case"up":g.value=We;break;case"down":g.value=z;break}T.value||(T.value=!0,fe())}function X(){if(l.direction){l.currentSpeed=Math.min(l.maxSpeed,l.currentSpeed+l.acceleration);let e=u.x,o=u.y;switch(l.direction){case"left":e-=l.currentSpeed;break;case"right":e+=l.currentSpeed;break;case"up":o-=l.currentSpeed;break;case"down":o+=l.currentSpeed;break}pe(e,o),N()}else{l.currentSpeed=l.baseSpeed,T.value=!1;return}S=requestAnimationFrame(X)}function fe(){S&&cancelAnimationFrame(S),S=requestAnimationFrame(X)}function L(){S&&(cancelAnimationFrame(S),S=null),T.value=!1,l.currentSpeed=l.baseSpeed}function Y(e){if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key))switch(p[e.key]=!0,e.key){case"ArrowLeft":f("left");break;case"ArrowRight":f("right");break;case"ArrowUp":f("up");break;case"ArrowDown":f("down");break}}function K(e){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)&&(p[e.key]=!1),Object.values(p).some(t=>t)?p.ArrowLeft?f("left"):p.ArrowRight?f("right"):p.ArrowUp?f("up"):p.ArrowDown&&f("down"):(l.direction=null,g.value=z,L())}function N(){if(!x.value)return;const e=x.value.clientWidth,o=x.value.clientHeight;let t=-u.x+e/2,a=-u.y+o/2;const M=0,O=0,B=e-Z,E=o-ee;t=Math.min(M,Math.max(B*c.zoom,t)),a=Math.min(O,Math.max(E*c.zoom,a)),c.x=t,c.y=a,ye()}function he(){c.zoom=1,u.x=150,u.y=150,g.value=z,l.direction=null,l.currentSpeed=l.baseSpeed,L(),Object.keys(p).forEach(e=>{p[e]=!1}),N()}function ye(){H.value&&(H.value.style.transform=`translate(${c.x}px, ${c.y}px) scale(${c.zoom})`,P.value&&(P.value.style.left=`${u.x}px`,P.value.style.top=`${u.y}px`))}function ge(){_.message="HI",_.visible=!0,_.timer&&clearTimeout(_.timer),_.timer=setTimeout(()=>{_.visible=!1},2e3)}function _e(){const e={zone:U.value,mode:"static",position:{left:"50%",top:"50%"},color:"blue",size:100},o=Te.create(e);o.on("move",(t,a)=>{a.direction&&f(a.direction.angle)}),o.on("end",()=>{l.direction=null,g.value=z,L()})}function we(){const e=["restaurant","local_pizza","cake","local_cafe","fastfood","local_bar","icecream","set_meal","bakery_dining","brunch_dining","lunch_dining","dinner_dining"],t={icon:e[Math.floor(Math.random()*e.length)],name:`料理 ${Math.floor(Math.random()*100)+1}`},a=ce(t);console.log(a?`添加了道具: ${t.name}`:"道具欄已滿")}function ke(){for(let e=0;e<s.value.length;e++)s.value[e]!==null&&ue(e);$.value=-1,console.log("道具欄已清空")}const w=r([{x:50,y:50},{x:250,y:100},{x:400,y:200},{x:100,y:300},{x:300,y:350}]);function be(e){const o=e.currentTarget.getBoundingClientRect(),t=.5,a=(e.clientX-o.left)/t,M=(e.clientY-o.top)/t;w.value.push({x:a,y:M}),console.log(`在 (${Math.round(a)}, ${Math.round(M)}) 添加了障礙物`)}function xe(){const e=Math.floor(Math.random()*900)+50,o=Math.floor(Math.random()*900)+50;w.value.push({x:e,y:o}),console.log(`在 (${e}, ${o}) 添加了障礙物`)}function Se(e){w.value.splice(e,1),console.log(`移除了障礙物 #${e}`)}function $e(){w.value=[],console.log("清除了所有障礙物")}function Me(){const e=w.value.map(t=>({x:t.x,y:t.y})),o=JSON.stringify(e,null,2);navigator.clipboard.writeText(o).then(()=>{D.notify({message:"障礙物數據已複製到剪貼簿！",color:"positive",icon:"content_copy"})}).catch(t=>{D.notify({message:"複製失敗，請手動複製。",color:"negative",icon:"report_problem"}),console.error("複製失敗:",t)})}return Ce(()=>{he(),window.addEventListener("keydown",Y),window.addEventListener("keyup",K),D.platform.is.mobile&&_e(),Q()}),Ae(()=>{window.removeEventListener("keydown",Y),window.removeEventListener("keyup",K),L(),v.value&&(clearInterval(v.value),v.value=null)}),(e,o)=>(i(),G(De,{class:"flex row"},{default:Ie(()=>[n("div",{class:"left-area",style:k(te.value)},[n("div",Oe,[m(h,{round:"",size:"sm",color:"primary",icon:"code",onClick:ne,class:"dev-mode-toggle",title:y.value?"隱藏開發區":"顯示開發區"},null,8,["title"])]),n("div",Be,[n("div",Ee,[m(J,{name:"restaurant",size:"20px",class:"q-mr-xs"}),n("span",null,R(j.value),1)]),n("div",{class:V(["timer",{"timer-warning":C.value<=30}])},R(se.value),3)]),n("div",{class:"camera-test-container q-mt-lg",ref_key:"cameraContainer",ref:x,style:k(oe.value)},[n("div",{class:"game-world",ref_key:"gameWorld",ref:H},[n("div",{class:"player",ref_key:"player",ref:P},[_.visible?(i(),d("div",Ue,R(_.message),1)):q("",!0),m(Le,{spriteSheet:g.value,frameWidth:48,frameHeight:38,totalFrames:4,animationDuration:"1s",scale:2},null,8,["spriteSheet"])],512),(i(!0),d(F,null,W(w.value,(t,a)=>(i(),d("div",{class:"obstacle",key:a,style:k({left:`${t.x}px`,top:`${t.y}px`})},null,4))),128))],512)],4),qe(D).platform.is.mobile?(i(),d("div",Qe,[n("div",{ref_key:"joystickZone",ref:U,class:"joystick-zone"},null,512),n("div",Xe,[m(h,{round:"",color:"red",icon:"campaign",onClick:ge,size:"lg",push:""})])])):q("",!0),n("div",Ye,[n("div",Ke,[(i(),d(F,null,W(6,t=>n("div",{key:t,class:V(["inventory-slot",{selected:$.value===t-1}]),onClick:a=>ie(t-1)},[s.value[t-1]?.icon?(i(),G(J,{key:0,name:s.value[t-1].icon,size:"24px",class:"inventory-item"},null,8,["name"])):q("",!0)],10,Ne)),64))]),n("div",{class:"minimap",style:k(ve.value)},[n("div",Ge,[(i(!0),d(F,null,W(w.value,(t,a)=>(i(),d("div",{class:"minimap-obstacle",key:a,style:k({left:`${t.x*b}px`,top:`${t.y*b}px`})},null,4))),128)),n("div",{class:"minimap-player",style:k(me.value)},null,4),n("div",{class:"viewport-rect",style:k(de.value)},null,4)])],4)])],4),y.value?(i(),d("div",Je)):q("",!0),y.value?(i(),d("div",Ve,[n("div",Ze,[o[1]||(o[1]=n("h5",{class:"q-mt-none q-mb-md"},"開發控制",-1)),n("div",et,[n("div",tt,[m(h,{color:"negative",icon:"restart_alt",label:"重置計時器",onClick:re,class:"full-width"})]),n("div",ot,[m(h,{color:"positive",icon:"add",label:"增加10分",onClick:o[0]||(o[0]=t=>ae(10)),class:"full-width"})])]),o[2]||(o[2]=n("h5",{class:"q-mt-md q-mb-md"},"道具欄測試",-1)),n("div",nt,[n("div",at,[m(h,{color:"primary",icon:"add_circle",label:"添加隨機道具",onClick:we,class:"full-width q-mb-sm"})]),n("div",lt,[m(h,{color:"warning",icon:"delete",label:"清空道具欄",onClick:ke,class:"full-width"})])])]),n("div",st,[o[3]||(o[3]=n("h5",{class:"q-mt-none q-mb-md"},"地圖規劃",-1)),n("div",rt,[n("div",it,[m(h,{color:"primary",icon:"add_box",label:"添加障礙物",onClick:xe,class:"full-width"})]),n("div",ct,[m(h,{color:"negative",icon:"delete_sweep",label:"清除障礙物",onClick:$e,class:"full-width"})])]),n("div",ut,[n("div",dt,[m(h,{color:"secondary",icon:"content_copy",label:"複製障礙物數據",onClick:Me,class:"full-width"})])]),n("div",mt,[n("div",{class:"planning-map",onClick:be},[(i(!0),d(F,null,W(w.value,(t,a)=>(i(),d("div",{class:"planning-obstacle",key:a,style:k({left:`${t.x}px`,top:`${t.y}px`}),onClick:ze(M=>Se(a),["stop"]),title:`障礙物 #${a+1} (${Math.round(t.x)}, ${Math.round(t.y)})`},[n("span",pt,R(a+1),1)],12,vt))),128))])])])])):q("",!0)]),_:1}))}}),At=je(ft,[["__scopeId","data-v-9f1d5cc6"]]);export{At as default};
