<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Walker - 風格模板與地圖管理</title>
    <link rel="stylesheet" href="admin-style.css">
</head>
<body>
    <div class="admin-container">
        <h1>Simple Walker - 風格模板與地圖管理</h1>

        <!-- Template Selection -->
        <div class="template-selector">
            <label for="template-select">選擇模板:</label>
            <select id="template-select">
                <option value="">-- 請選擇或新增 --</option>
            </select>
            <button id="load-template-btn">載入編輯</button>
            <button id="new-template-btn">新增模板</button>
        </div>
        <hr>

        <!-- Template Editor (包含樣式和格子預覽) -->
        <div id="template-editor" class="hidden">
            <h2>編輯模板樣式</h2>
            <div class="form-group">
                <label for="template-id">模板 ID:</label> <!-- 創建時可編輯，載入後只讀 -->
                <input type="text" id="template-id" placeholder="小寫英文、數字、底線">
            </div>
            <div class="form-group">
                <label for="template-name">模板名稱:</label>
                <input type="text" id="template-name" placeholder="例如：經典綠">
            </div>
             <div class="form-group">
                <label for="template-description">模板描述:</label>
                <textarea id="template-description" rows="2"></textarea>
            </div>

            <!-- 樣式設定 Fieldsets -->
            <fieldset>
                <legend>[全局樣式 / General]</legend>
                <div class="form-group"> <label for="general-pageBgColor">頁面背景色:</label> <input type="color" id="general-pageBgColor"> </div>
                <div class="form-group"> <label for="general-primaryTextColor">主要文字顏色:</label> <input type="color" id="general-primaryTextColor"> </div>
                <div class="form-group"> <label for="general-primaryFontFamily">主要字體:</label> <input type="text" id="general-primaryFontFamily" placeholder="例如: 'Microsoft JhengHei', sans-serif"> </div>
            </fieldset>

            <fieldset>
                <legend>[遊戲標題區 / Header]</legend>
                <div class="form-group"> <label for="header-headerBgColor">標題背景色:</label> <input type="color" id="header-headerBgColor"> </div>
                <div class="form-group"> <label for="header-headerTextColor">標題文字顏色:</label> <input type="color" id="header-headerTextColor"> </div>
                <div class="form-group"> <label for="header-roomInfoColor">房間資訊文字顏色:</label> <input type="color" id="header-roomInfoColor"> </div>
            </fieldset>

            <fieldset>
                <legend>[遊戲地圖區 / Game Board]</legend>
                <div class="form-group"> <label for="board-borderColor">地圖外框線顏色:</label> <input type="color" id="board-borderColor"> </div>
                <div class="form-group"> <label for="board-borderWidth">地圖外框線寬度:</label> <input type="text" id="board-borderWidth" placeholder="例如: 2px"> </div>
                <div class="form-group"> <label for="board-centerBgColor">地圖中央背景色:</label> <input type="color" id="board-centerBgColor"> </div>
                <div class="form-group"> <label for="board-centerImageUrl">地圖中央圖片 URL:</label> <input type="url" id="board-centerImageUrl" placeholder="https://..."> </div>
            </fieldset>

             <fieldset>
                <legend>[地圖格子 (預設樣式) / Map Cell Defaults]</legend>
                <div class="form-group"> <label for="mapCell-defaultBgColor">預設背景色:</label> <input type="color" id="mapCell-defaultBgColor"> </div>
                <div class="form-group"> <label for="mapCell-defaultBorderColor">預設邊框顏色:</label> <input type="color" id="mapCell-defaultBorderColor"> </div>
                <div class="form-group"> <label for="mapCell-defaultBorderWidth">預設邊框寬度:</label> <input type="text" id="mapCell-defaultBorderWidth" placeholder="例如: 1px"> </div>
                <div class="form-group"> <label for="mapCell-titleTextColor">標題文字顏色:</label> <input type="color" id="mapCell-titleTextColor"> </div>
                <div class="form-group"> <label for="mapCell-numberTextColor">編號文字顏色:</label> <input type="color" id="mapCell-numberTextColor"> </div>
                <div class="form-group"> <label for="mapCell-hoverBgColor">滑鼠懸停背景色:</label> <input type="color" id="mapCell-hoverBgColor"> </div>
                <div class="form-group"> <label for="mapCell-hoverBorderColor">滑鼠懸停邊框色:</label> <input type="color" id="mapCell-hoverBorderColor"> </div>
            </fieldset>

             <fieldset>
                <legend>[玩家標記 / Player Marker]</legend>
                <div class="form-group"> <label for="playerMarker-shape">標記形狀 (border-radius):</label> <input type="text" id="playerMarker-shape" placeholder="例如: 50%"> </div>
                <div class="form-group"> <label for="playerMarker-textColor">標記文字顏色:</label> <input type="color" id="playerMarker-textColor"> </div>
                 <div class="form-group"> <label for="playerMarker-boxShadow">標記陰影 (CSS):</label> <input type="text" id="playerMarker-boxShadow" placeholder="例如: 0 2px 4px rgba(0,0,0,0.2)"> </div>
                <div class="form-group player-color-group">
                     <label>玩家顏色組 (最多5個):</label>
                     <input type="color" id="playerMarker-color1">
                     <input type="color" id="playerMarker-color2">
                     <input type="color" id="playerMarker-color3">
                     <input type="color" id="playerMarker-color4">
                     <input type="color" id="playerMarker-color5">
                </div>
            </fieldset>

             <fieldset>
                <legend>[控制區 / Controller Area]</legend>
                 <div class="form-group"> <label for="controller-panelBackground">面板背景色:</label> <input type="color" id="controller-panelBackground"> </div>
                <div class="form-group"> <label for="controller-playerLabelColor">'玩家:' 文字顏色:</label> <input type="color" id="controller-playerLabelColor"> </div>
                <fieldset>
                    <legend>控制按鈕 / Control Buttons</legend>
                    <div class="form-group"> <label for="controller-button-defaultBgColor">預設背景色:</label> <input type="color" id="controller-button-defaultBgColor"> </div>
                    <div class="form-group"> <label for="controller-button-defaultTextColor">預設文字顏色:</label> <input type="color" id="controller-button-defaultTextColor"> </div>
                    <div class="form-group"> <label for="controller-button-borderRadius">圓角大小:</label> <input type="text" id="controller-button-borderRadius" placeholder="例如: 5px"> </div>
                    <div class="form-group"> <label for="controller-button-hoverBgColor">懸停背景色:</label> <input type="color" id="controller-button-hoverBgColor"> </div>
                    <div class="form-group"> <label for="controller-button-cooldownOpacity">冷卻時不透明度:</label> <input type="text" id="controller-button-cooldownOpacity" placeholder="例如: 0.6"> </div>
                 </fieldset>
            </fieldset>

             <fieldset>
                 <legend>[資訊區 / Info Area]</legend>
                 <div class="form-group"> <label for="info-panelBackground">面板背景色:</label> <input type="color" id="info-panelBackground"> </div>
                 <div class="form-group"> <label for="info-sectionTitleColor">區塊標題顏色:</label> <input type="color" id="info-sectionTitleColor"> </div>
                 <div class="form-group"> <label for="info-playerListText">玩家列表文字顏色:</label> <input type="color" id="info-playerListText"> </div>
                 <div class="form-group"> <label for="info-staticTextColor">靜態文字顏色:</label> <input type="color" id="info-staticTextColor"> </div>
                 <fieldset>
                     <legend>離開遊戲按鈕 / Leave Button</legend>
                    <div class="form-group"> <label for="info-leaveButton-defaultBgColor">預設背景色:</label> <input type="color" id="info-leaveButton-defaultBgColor"> </div>
                    <div class="form-group"> <label for="info-leaveButton-defaultTextColor">預設文字顏色:</label> <input type="color" id="info-leaveButton-defaultTextColor"> </div>
                 </fieldset>
            </fieldset>

             <fieldset>
                <legend>[連線狀態 / Connection Status]</legend>
                <div class="form-group"> <label for="connection-onlineBgColor">線上背景色:</label> <input type="color" id="connection-onlineBgColor"> </div>
                <div class="form-group"> <label for="connection-onlineTextColor">線上文字顏色:</label> <input type="color" id="connection-onlineTextColor"> </div>
                <div class="form-group"> <label for="connection-offlineBgColor">離線背景色:</label> <input type="color" id="connection-offlineBgColor"> </div>
                <div class="form-group"> <label for="connection-offlineTextColor">離線文字顏色:</label> <input type="color" id="connection-offlineTextColor"> </div>
                <div class="form-group"> <label for="connection-connectingBgColor">連接中背景色:</label> <input type="color" id="connection-connectingBgColor"> </div>
                <div class="form-group"> <label for="connection-connectingTextColor">連接中文字顏色:</label> <input type="color" id="connection-connectingTextColor"> </div>
            </fieldset>

             <fieldset>
                <legend>[地點彈窗 (預設樣式) / Location Modal Defaults]</legend>
                 <div class="form-group"> <label for="modal-overlayBgColor">遮罩背景色 (rgba):</label> <input type="text" id="modal-overlayBgColor" placeholder="例如: rgba(0, 0, 0, 0.7)"> </div>
                 <div class="form-group"> <label for="modal-contentBgColor">彈窗內容背景色:</label> <input type="color" id="modal-contentBgColor"> </div>
                 <div class="form-group"> <label for="modal-headerBgColor">彈窗頭部背景色 (預設):</label> <input type="color" id="modal-headerBgColor"> </div>
                 <div class="form-group"> <label for="modal-headerTextColor">彈窗頭部文字色:</label> <input type="color" id="modal-headerTextColor"> </div>
                 <div class="form-group"> <label for="modal-bodyTextColor">彈窗內文文字色:</label> <input type="color" id="modal-bodyTextColor"> </div>
            </fieldset>

            <hr> <!-- 分隔線 -->

            <!-- Map Cell Editor (現在是模板的一部分) -->
            <div id="cell-editor">
                <h2>編輯地圖格子 (點擊下方格子進行編輯)</h2>
                <p>(格子顏色設定將覆蓋模板預設值，清除顏色則使用模板預設)</p>
                <div id="admin-map-grid-container">
                    <div id="admin-map-grid">
                        <!-- JS 會在此生成格子預覽 -->
                    </div>
                    
                <!-- ★★★ 移除了獨立的儲存格子按鈕 ★★★ -->
            </div>
 <!-- ★★★ 新增：用於顯示模板描述的 Div ★★★ -->
 <div id="admin-map-center-text"></div>
 <!-- ★★★ 結束新增 ★★★ -->
 </div>
            <hr> <!-- 分隔線 -->

            <!-- 統一的儲存按鈕 -->
            <button id="save-template-btn" class="btn-primary" style="width: 100%; padding: 15px; font-size: 18px; margin-top: 20px;">儲存模板 (包含樣式和格子變更)</button>
            <button id="delete-template-btn" class="btn-danger hidden" style="width: 100%; margin-top: 10px;">刪除此模板</button>

        </div> <!-- End of template-editor -->


        <!-- Status Message -->
        <div id="status-message"></div>
    </div>

    <!-- Cell Edit Modal (保持不變) -->
    <div id="cell-edit-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-cell-title-display">編輯格子 <span id="modal-cell-index-display"></span></h2>
                <button class="close-modal-btn" onclick="closeCellEditModal()">×</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editing-cell-index">
                <div class="form-group">
                    <label for="modal-cell-title-input">標題:</label>
                    <input type="text" id="modal-cell-title-input">
                </div>
                <div class="form-group">
                    <label for="modal-cell-desc-textarea">內文描述:</label>
                    <textarea id="modal-cell-desc-textarea" rows="4"></textarea>
                </div>
                <hr>
                <div class="form-group">
                    <label for="modal-cell-bg-color-input">格子背景色 (覆蓋):</label>
                    <input type="color" id="modal-cell-bg-color-input">
                    <button onclick="clearColorInput('modal-cell-bg-color-input')">清除 (使用預設)</button>
                </div>
                 <div class="form-group">
                    <label for="modal-modal-header-bg-color-input">彈窗頭部背景色 (覆蓋):</label>
                    <input type="color" id="modal-modal-header-bg-color-input">
                    <button onclick="clearColorInput('modal-modal-header-bg-color-input')">清除 (使用預設)</button>
                </div>
            </div>
            <div class="modal-footer">
                <button id="save-modal-changes-btn" class="btn-primary">儲存此格變更 (暫存)</button>
                <button onclick="closeCellEditModal()">取消</button>
            </div>
        </div>
    </div>

    <script src="rich-admin.js"></script>
    <script>
        // Helper functions (保持不變)
        function closeCellEditModal() {
            document.getElementById('cell-edit-modal').classList.add('hidden');
        }
        function clearColorInput(inputId) {
            const input = document.getElementById(inputId);
            input.value = '#ffffff';
            input.dataset.cleared = 'true';
        }
    </script>
</body>
</html>