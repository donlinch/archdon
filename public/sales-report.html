<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>銷售報告 - 管理後台</title>
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
     <!-- 添加 date-fns 庫 (Chart.js 時間軸需要) -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/2.29.3/date-fns.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/2.29.3/locale/zh-TW/index.min.js"></script> <!-- 中文 locale -->

    <style>
        /* 添加一些此頁面特定的簡單樣式 */
        .report-container { max-width: 1200px; margin: 20px auto; padding: 15px; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .filter-controls { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
        .filter-controls label { margin-right: 5px; font-weight: bold;}
        .filter-controls input[type="date"], .filter-controls button { padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; }
        .filter-controls button { background-color: #f0f0f0; cursor: pointer; }
        .filter-controls button.active { background-color: #FFB74D; color: #424242; font-weight: bold; border-color: #FFB74D;}
        .summary-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .card { background-color: #f9f9f9; padding: 15px; border-radius: 5px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .card h3 { margin-top: 0; margin-bottom: 8px; font-size: 0.9rem; color: #555; }
        .card p { font-size: 1.8rem; font-weight: bold; color: #E57373; margin: 0; }
        .chart-section, .table-section { margin-bottom: 30px; }
        .chart-section h2, .table-section h2 { font-size: 1.3rem; margin-bottom: 15px; color: #444; border-bottom: 2px solid #FFB74D; padding-bottom: 5px;}
        .chart-container { position: relative; height: 350px; width: 100%; } /* 調整高度 */
        .table-container { max-height: 500px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        th, td { padding: 10px 8px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f2f2f2; font-weight: bold; }
        tbody tr:hover { background-color: #f5f5f5; }
        #loading-indicator, #error-message { text-align: center; padding: 20px; font-size: 1.1rem; display: none; }
        #error-message { color: red; }
    </style>
</head>
<body>
    <!-- 可以複製 admin.html 的導航列過來 -->
    <nav class="admin-nav">
         <a href="/admin.html">商品管理</a>
         <a href="/music-admin.html">音樂管理</a>
         <a href="/news-admin.html">消息管理</a>
         <a href="/banner-admin.html">Banner管理</a>
         <a href="/figures-admin.html">公仔庫存</a>
         <a href="/sales-report.html" class="active">銷售報告</a>
    </nav>

    <div class="report-container">
        <h1>銷售報告</h1>

        <!-- Filter Controls -->
        <div class="filter-controls">
            <button id="btn-today">今天</button>
            <button id="btn-last7">過去7天</button>
            <button id="btn-last30" class="active">過去30天</button>
            <label for="start-date">自訂範圍:</label>
            <input type="date" id="start-date">
            <span>至</span>
            <input type="date" id="end-date">
            <button id="btn-custom-range">查詢</button>
        </div>

        <!-- Loading and Error Indicators -->
        <div id="loading-indicator">正在載入報告數據...</div>
        <div id="error-message"></div>

        <!-- Summary Cards -->
        <div class="summary-cards">
            <div class="card">
                <h3>總銷售件數</h3>
                <p id="total-items-sold">--</p>
            </div>
            <!-- 可以根據需要添加更多卡片，例如總銷售額 (如果後端有計算) -->
        </div>

        <!-- Sales Trend Chart -->
        <div class="chart-section">
            <h2>銷售數量趨勢</h2>
            <div class="chart-container">
                <canvas id="salesTrendChart"></canvas>
            </div>
        </div>

        <!-- Top Selling Products -->
        <div class="chart-section">
             <h2>熱銷商品排行 (Top 10)</h2>
             <div class="chart-container" style="height: 400px;"> {/* 可能需要更高的高度 */}
                 <canvas id="topProductsChart"></canvas>
             </div>
             {/* 或者使用表格顯示
             <div class="table-container" id="topProductsTableContainer">
                 <table>
                     <thead>
                         <tr>
                             <th>排名</th>
                             <th>公仔名稱</th>
                             <th>規格</th>
                             <th>銷售數量</th>
                         </tr>
                     </thead>
                     <tbody id="topProductsTableBody">
                         </tbody>
                 </table>
             </div> */}
         </div>

        <!-- Detailed Sales Log -->
        <div class="table-section">
            <h2>詳細銷售紀錄</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>銷售時間</th>
                            <th>公仔名稱</th>
                            <th>規格</th>
                            <th>數量</th>
                        </tr>
                    </thead>
                    <tbody id="detailedLogTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script src="sales-report.js"></script>
</body>
</html>