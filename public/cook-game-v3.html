<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>æ–™ç†æ€¥å…ˆé‹’ V3 - éŠæˆ²</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#333333">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
  <link href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #32a852;
      --secondary-color: #4CAF50;
      --accent-color: #FF9800;
      --text-color: #f0f0f0;
      --bg-color: #222222;
      --border-color: #444444;
      --success-color: #4CAF50;
      --error-color: #F44336;
      --card-bg-color: rgba(0, 0, 0, 0.5);
      --station-bg: #161b22;
      --station-border: #30363d;
      --station-hover: #30363d;
      --inventory-bg: #010409;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      background: #1a1a1a;
      color: #fff;
      font-family: 'Courier New', monospace;
      -webkit-user-select: none; /* Safari */
      -ms-user-select: none; /* IE 10+ and Edge */
      user-select: none; /* Standard syntax */
    }
    
    .game-container {
      width: 100%;
      max-width: 480px; /* æ‰‹æ©Ÿç‰ˆé¢æœ€å¤§å¯¬åº¦ */
      min-height: 100vh;
      margin: 0 auto;
      background: #0d1117; /* æ·±è‰²èƒŒæ™¯ */
      display: flex;
      flex-direction: column;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      position: relative;
    }
    
    .loading-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--bg-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .loader {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 5px solid var(--border-color);
      border-top-color: var(--accent-color);
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    .loading-text {
      font-size: 1.2em;
      color: var(--accent-color);
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .game-ui {
      display: flex;
      flex-direction: column;
      height: 100%;
      flex-grow: 1;
      visibility: visible;
    }
    
    .game-header {
      height: 50px;
      background-color: rgba(0, 0, 0, 0.7);
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      align-items: center;
      padding: 0 15px;
      border-bottom: 1px solid var(--border-color);
      z-index: 10;
      flex-shrink: 0;
    }
    
    .game-score {
      font-size: 1.2em;
      color: var(--secondary-color);
      text-align: center;
      grid-column: 2;
    }
    
    .game-timer {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 90px;
      height: 35px;
      background-color: #32a852;
      border-radius: 8px;
      padding: 4px;
      border: none;
      justify-self: end;
      grid-column: 3;
    }

    .game-timer-inner {
      width: 100%;
      height: 100%;
      background-color: #3e2723;
      color: #a5d6a7;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4em;
      font-family: 'DS-Digital', monospace;
      border-radius: 4px;
    }
    
    .game-main {
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
      display: flex;
      flex-direction: column;
    }
    
    .orders-container {
      margin-bottom: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .order-card {
      background-color: var(--station-bg);
      border: 1px solid var(--station-border);
      border-radius: 8px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .order-name {
      font-size: 1.1em;
      font-weight: bold;
      color: #c9d1d9;
    }

    .order-ingredients {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 8px 0;
    }

    .order-ingredient-item {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      padding: 4px 8px;
      border: 1px solid var(--station-border);
    }

    .order-ingredient-icon {
      font-size: 1.2em;
      margin-right: 4px;
    }
    
    .order-timer-container {
      width: 100%;
    }

    .order-timer-text {
        font-size: 0.9em;
        color: #8b949e;
        margin-bottom: 4px;
        text-align: right;
    }
    
    .order-timer {
      width: 100%;
      height: 6px;
      background-color: var(--station-border);
      border-radius: 3px;
      overflow: hidden;
    }

    .order-timer-fill {
      height: 100%;
      background-color: var(--success-color);
      border-radius: 3px;
      transition: width 0.5s linear;
    }

    .work-area {
        display: grid;
        grid-template-areas:
            "stations"
            "assembly";
        grid-template-rows: auto auto;
        gap: 15px;
        margin-top: auto; /* å°‡å·¥ä½œå€æ¨åˆ° game-main åº•éƒ¨ */
    }

    .stations-container {
      grid-area: stations;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }
    
    .station {
      background-color: var(--station-bg);
      border: 2px solid var(--station-border);
      border-radius: 8px;
      padding: 10px 5px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .station.highlight {
        border-color: var(--accent-color);
        box-shadow: 0 0 10px var(--accent-color);
    }
    
    .station-icon {
        font-size: 1.8em;
    }

    .station-label {
        margin-top: 5px;
        color: #8b949e;
        font-size: 0.8em;
    }
    
    .progress-bar-container {
        position: absolute;
        bottom: 5px;
        left: 10%;
        width: 80%;
        height: 8px;
        background-color: rgba(0,0,0,0.5);
        border-radius: 4px;
        overflow: hidden;
        display: none; /* é è¨­éš±è— */
    }

    .progress-bar {
        width: 0%;
        height: 100%;
        background-color: var(--accent-color);
        border-radius: 4px;
        transition: width 0.1s linear;
    }

    .assembly-plate {
        grid-area: assembly;
        background-color: var(--station-bg);
        border: 1px solid var(--station-border);
        border-radius: 8px;
        padding: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .plate-slots-container {
        flex-grow: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 5px;
    }
    .plate-slot {
        width: 50px;
        height: 50px;
        background: var(--inventory-bg);
        border: 2px dashed var(--station-border);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8em;
        transition: all 0.2s ease;
    }
    .plate-slot.filled {
        border-style: solid;
        border-color: var(--secondary-color);
    }
    .plate-operator {
        font-size: 20px;
        font-weight: bold;
        color: #8b949e;
    }
    .plate-button {
        background-color: var(--primary-color);
        color: white;
        border: none;
        padding: 0 20px;
        height: 50px;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
        font-size: 1em;
    }
    .plate-button:disabled {
        background-color: #555;
        cursor: not-allowed;
    }

    .player-area {
      position: sticky;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(13, 17, 23, 0.8);
      backdrop-filter: blur(5px);
      padding: 10px;
      border-top: 1px solid var(--station-border);
      flex-shrink: 0;
    }

    .player-inventory {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 8px;
    }

    .inventory-slot {
      aspect-ratio: 1;
      background: var(--inventory-bg);
      border: 2px solid var(--station-border);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
    }
    
    .inventory-slot.active {
      border-color: var(--accent-color);
      transform: scale(1.1);
      box-shadow: 0 0 10px var(--accent-color);
    }

    .inventory-slot.selected-for-assembly {
        border-color: var(--accent-color);
        box-shadow: 0 0 10px var(--accent-color);
    }

    .item-quantity {
        position: absolute;
        bottom: 2px;
        right: 4px;
        font-size: 0.8em;
        font-weight: bold;
        color: var(--text-color);
        background-color: rgba(0,0,0,0.7);
        padding: 0 4px;
        border-radius: 4px;
    }
    
    .dialog {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .dialog-content {
      background-color: var(--bg-color);
      border: 1px solid var(--border-color);
      border-radius: 5px;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
    
    .dialog-title {
      font-size: 1.5em;
      margin-bottom: 15px;
      color: var(--secondary-color);
    }
    
    .dialog-text {
      margin-bottom: 20px;
    }
    
    .dialog-button {
      background-color: var(--accent-color);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      margin: 0 10px;
    }
    
    .toast {
      position: fixed;
      top: -100px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 12px 24px;
      border-radius: 20px;
      z-index: 1001;
      opacity: 0;
      transition: top 0.5s ease, opacity 0.3s ease;
      text-align: center;
    }
    
    .toast.show {
      top: 60px;
      opacity: 1;
    }
    
    .toast.success {
      border-left: 4px solid var(--success-color);
    }
    
    .toast.error {
      border-left: 4px solid var(--error-color);
    }

    /* V3 æ–°å¢æ¨£å¼ */
    .modal-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.6);
        z-index: 1000;
        display: none; /* é è¨­éš±è— */
    }

    .selection-menu {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 400px;
        background-color: var(--bg-color);
        border: 2px solid var(--accent-color);
        border-radius: 12px;
        z-index: 1001;
        padding: 20px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        display: none; /* é è¨­éš±è— */
    }

    .selection-menu-title {
        font-size: 1.3em;
        color: var(--accent-color);
        text-align: center;
        margin-bottom: 20px;
    }

    .selection-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: 15px;
    }

    .selection-item {
        background-color: var(--station-bg);
        border: 1px solid var(--station-border);
        border-radius: 8px;
        padding: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    .selection-item:hover {
        background-color: var(--station-hover);
        transform: translateY(-3px);
    }
    .selection-item-icon {
        font-size: 2em;
        margin-bottom: 8px;
    }
    .selection-item-name {
        font-size: 0.9em;
        text-align: center;
    }

    /* æ–°å¢ï¼šåˆ†é¡éæ¿¾æŒ‰éˆ•æ¨£å¼ */
    .category-filter-container {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .category-filter-btn {
      padding: 5px 10px;
      background-color: var(--bg-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .category-filter-btn:hover {
      background-color: var(--border-color);
    }

    .category-filter-btn.active {
      background-color: var(--accent-color);
      border-color: var(--accent-color);
      color: #fff;
    }

    /* æ–°å¢ï¼šåŠ å·¥æ–¹æ³•é¸æ“‡èœå–®æ¨£å¼ */
    .processing-methods-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: var(--card-bg-color);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      width: 90%;
      max-width: 500px;
      z-index: 1001;
    }

    .processing-methods-container h3 {
      text-align: center;
      margin-top: 0;
      margin-bottom: 15px;
      color: var(--text-color);
    }

    .processing-methods-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
    }

    .processing-method-item {
      background-color: var(--bg-color);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .processing-method-item:hover {
      background-color: var(--border-color);
      transform: translateY(-2px);
    }

    .method-icon {
      font-size: 24px;
      margin-bottom: 5px;
    }

    .method-name {
      font-weight: bold;
      margin-bottom: 8px;
    }

    .method-result {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 0.9em;
      color: var(--text-muted-color);
    }

    .result-icon {
      font-size: 20px;
      margin-bottom: 3px;
    }

    /* ç‰©å“é›™æ“Šæ•ˆæœ */
    .inventory-slot {
      transition: transform 0.1s ease;
    }

    .inventory-slot:active {
      transform: scale(0.95);
    }

    /* é–‹ç™¼æ¨¡å¼æŒ‡ç¤ºå™¨ */
    .dev-mode-indicator {
      position: fixed;
      top: 10px;
      right: 10px;
      background-color: rgba(255, 0, 0, 0.7);
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 1000;
    }

    .game-container {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 20px;
      padding: 20px;
      height: calc(100vh - 40px);
    }

    .inventory-section {
      background: #f5f5f5;
      border-radius: 10px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      overflow-y: auto;
    }

    .cooking-section {
      display: grid;
      grid-template-rows: 3fr 1fr;
      gap: 15px;
    }

    .cooking-stations {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 15px;
      padding: 15px;
      background: #e9ecef;
      border-radius: 10px;
    }

    .assembly-plate {
      background: #dee2e6;
      border-radius: 10px;
      padding: 15px;
      min-height: 150px;
    }

    .orders-section {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 15px;
      overflow-y: auto;
    }

    .cooking-station {
      background: white;
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      border: 2px solid #ced4da;
      min-height: 120px;
    }

    .ingredient-category {
      background: white;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
    }

    .ingredient {
      display: inline-block;
      background: #e9ecef;
      border: 1px solid #ced4da;
      border-radius: 4px;
      padding: 5px 10px;
      margin: 3px;
      cursor: move;
    }

    .order-card {
      background: white;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #dee2e6;
    }

    .timer {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 24px;
      z-index: 1000;
    }

    .draggable-item {
      cursor: move;
      user-select: none;
    }

    .droppable-highlight {
      border: 2px dashed #007bff !important;
    }

    .cooking-progress {
      display: none;
      width: 100%;
      height: 5px;
      background: #e9ecef;
      border-radius: 2px;
      margin-top: 5px;
    }

    .cooking-progress-bar {
      width: 0%;
      height: 100%;
      background: #28a745;
      border-radius: 2px;
      transition: width 0.1s linear;
    }

    .score {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 24px;
      z-index: 1000;
    }

    /* éŠæˆ²è¨ˆæ™‚å™¨ */
    .game-timer {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 1.2em;
    }

    /* åˆ†æ•¸é¡¯ç¤º */
    .score-display {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 1.2em;
    }

    /* éŠæˆ²ä¸»å®¹å™¨æ¨£å¼ */
    .game-container {
      display: grid;
      grid-template-columns: 300px 1fr 300px;
      gap: 20px;
      padding: 20px;
      height: 100vh;
    }

    /* ç‰©å“å’Œé£Ÿæå€åŸŸæ¨£å¼ */
    .items-container {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      overflow-y: auto;
    }

    /* çƒ¹é£ªå€åŸŸæ¨£å¼ */
    .cooking-area {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }

    /* è¨‚å–®å€åŸŸæ¨£å¼ */
    .orders-container {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      overflow-y: auto;
    }

    /* æ¨¡æ“¬å™¨ç›¸é—œæ¨£å¼ */
    .sim-item {
      width: 80px;
      height: 80px;
      border: 1px solid #ddd;
      border-radius: 4px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background-color: white;
      cursor: grab;
      position: relative;
      user-select: none;
      margin: 5px;
    }

    .sim-item:active {
      cursor: grabbing;
    }

    .sim-item .ascii-symbol {
      font-size: 24px;
      line-height: 1;
    }

    .sim-item .item-name {
      font-size: 12px;
      text-align: center;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      width: 100%;
      padding: 0 4px;
    }

    .crafting-slot {
      position: relative;
      width: 100px;
      height: 100px;
      border: 2px dashed #ddd;
      border-radius: 8px;
      margin: 5px;
      transition: all 0.3s;
    }

    .crafting-slot.drag-over {
      border-color: #3498db;
      background-color: rgba(52, 152, 219, 0.1);
    }

    .cooking-stations {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }

    .cooking-station {
      flex: 1;
      min-width: 200px;
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
    }

    .station-title {
      font-size: 1.2em;
      margin-bottom: 10px;
      text-align: center;
    }

    .tier-0 { background-color: #e9ecef; }
    .tier-1 { background-color: #fff3cd; }
    .tier-2 { background-color: #d4edda; }

    .category-filter {
      margin-bottom: 10px;
    }

  </style>
</head>
<body>
  <!-- éŠæˆ²å®¹å™¨ -->
  <div class="game-container" id="gameContainer">
    <!-- éŠæˆ²è¼‰å…¥ç•«é¢ -->
    <div class="loading-screen" id="loadingScreen">
      <div class="loader"></div>
      <div class="loading-text">éŠæˆ²è¼‰å…¥ä¸­...</div>
    </div>

    <!-- éŒ¯èª¤è¨Šæ¯å®¹å™¨ -->
    <div id="error-container" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); z-index: 1000; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center; padding: 20px;">
      <h2 style="color: #ff5252;">éŠæˆ²åˆå§‹åŒ–å¤±æ•—</h2>
      <p id="error-message" style="margin: 20px 0; font-size: 18px; max-width: 80%;"></p>
      <button onclick="location.reload()" style="padding: 10px 20px; background-color: #4caf50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">é‡æ–°åŠ è¼‰</button>
    </div>

    <!-- éŠæˆ²UI -->
    <div class="game-ui" id="gameUI" style="visibility: hidden;">
      <div class="game-header">
        <div id="userStatus" style="display: flex; align-items: center; justify-self: start;">
          <!-- User Status Indicator will be here -->
        </div>
        <div class="game-score" id="gameScore">åˆ†æ•¸: 0</div>
        <div class="game-timer">
            <div id="gameTimerInner" class="game-timer-inner">03:00</div>
        </div>
      </div>
        
      <div class="game-main">
          <div class="orders-container" id="ordersContainer">
            <!-- è¨‚å–®å¡ç‰‡å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
          </div>

          <div class="work-area">
              <div class="stations-container" id="stationsContainer">
                  <!-- V3 å·¥ä½œç«™å°‡ç”±JSå‹•æ…‹ç”Ÿæˆ -->
              </div>
              <div class="assembly-plate" id="assemblyPlate">
                  <div class="plate-slots-container" id="assemblySlots">
                      <!-- çµ„åˆæ§½å°‡ç”±JSå‹•æ…‹ç”Ÿæˆ -->
                  </div>
                  <button id="assembleBtn" class="plate-button">çµ„åˆ</button>
              </div>
          </div>
      </div>
        
      <div class="player-area">
          <div class="player-inventory" id="playerInventory">
            <!-- 8å€‹åº«å­˜æ§½å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
          </div>
      </div>
      </div>
      
      <!-- éŠæˆ²çµæŸå°è©±æ¡† -->
      <div class="dialog" id="gameOverDialog" style="display: none;">
        <div class="dialog-content">
          <div class="dialog-title">éŠæˆ²çµæŸ</div>
          <div class="final-score-container" style="text-align: center; margin-bottom: 20px;">
              <div class="final-score-label" style="font-size: 1.2em; color: #ccc;">æœ€çµ‚åˆ†æ•¸</div>
              <div class="final-score" id="finalScore" style="font-size: 3em; font-weight: bold; color: var(--accent-color);">0</div>
          </div>
          <button class="dialog-button" id="returnToLobbyBtn">è¿”å›å¤§å»³</button>
        </div>
      </div>
      
      <!-- æç¤ºé€šçŸ¥ -->
      <div class="toast" id="toast"></div>
    </div>

    <!-- V3 æ–°å¢: å½ˆå‡ºé¸æ“‡èœå–® -->
    <div class="modal-backdrop" id="modalBackdrop"></div>
    <div class="selection-menu" id="ingredientMenu">
        <div class="selection-menu-title">é¸æ“‡åŸºç¤é£Ÿæ</div>
        <div class="selection-grid" id="ingredientGrid">
            <!-- é£Ÿæå°‡ç”± JS å‹•æ…‹ç”Ÿæˆ -->
        </div>
    </div>

  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // é©—è­‰é‚è¼¯ (ä¿ç•™)
      const checkAuthentication = () => {
          const cookGameToken = localStorage.getItem('cookGameToken');
          if (!cookGameToken) {
              const currentUrl = window.location.href;
              window.location.href = `/member-login.html?redirect=${encodeURIComponent(currentUrl)}`;
              return null;
          }
          return cookGameToken;
      };

      const token = checkAuthentication();
      if (!token) {
          return;
      }
      
      // DOM å…ƒç´ 
      const loadingScreen = document.getElementById('loadingScreen');
      const gameUI = document.getElementById('gameUI');
      const gameTimerInner = document.getElementById('gameTimerInner');
      const gameScore = document.getElementById('gameScore');
      const ordersContainer = document.getElementById('ordersContainer');
      const stationsContainer = document.getElementById('stationsContainer');
      const playerInventory = document.getElementById('playerInventory');
      const assemblySlotsContainer = document.getElementById('assemblySlots');
      const assembleBtn = document.getElementById('assembleBtn');
      const gameOverDialog = document.getElementById('gameOverDialog');
      const finalScore = document.getElementById('finalScore');
      const returnToLobbyBtn = document.getElementById('returnToLobbyBtn');
      const toast = document.getElementById('toast');
      const modalBackdrop = document.getElementById('modalBackdrop');
      const ingredientMenu = document.getElementById('ingredientMenu');
      const ingredientGrid = document.getElementById('ingredientGrid');

      // V3 éŠæˆ²ç‹€æ…‹
      let gameState = {
        inventory: Array(8).fill(null),
        assembly: [],
        assemblySelection: [],
        activeSlot: 0,
        score: 0,
        time: 180, // 3åˆ†é˜
        orders: [],
        isProcessing: false, // é˜²æ­¢é‡è¤‡æ“ä½œ
        selectedInventoryIndex: -1, // ç”¨æ–¼çµ„åˆå°
      };

      // V3 éŠæˆ²è³‡æ–™ (å¾Œç«¯ç²å–)
      let items_v3 = [];
      let recipes_v3 = [];

      // V3 éŠæˆ²ç‹€æ…‹
      let lastClickedSlot = -1;
      let lastClickTime = 0;

      // ===================================
      // Helper Functions
      // ===================================
      function showToast(message, type = 'info') {
        toast.textContent = message;
        toast.className = `toast show ${type}`;
        setTimeout(() => {
            toast.classList.remove('show');
        }, 2000);
      }

      function getItemName(itemId) {
        const item = items_v3.find(i => i.item_id === itemId);
        return item ? item.item_name : 'æœªçŸ¥ç‰©å“';
      }

      function openIngredientMenu() {
        ingredientGrid.innerHTML = '';
        const baseIngredients = items_v3.filter(item => item.item_tier === 0);
        
        baseIngredients.forEach(item => {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'selection-item';
            itemDiv.innerHTML = `
                <div class="selection-item-icon">${item.ascii_symbol}</div>
                <div class="selection-item-name">${item.item_name}</div>
            `;
            itemDiv.onclick = () => selectIngredient(item.item_id);
            ingredientGrid.appendChild(itemDiv);
        });

        modalBackdrop.style.display = 'block';
        ingredientMenu.style.display = 'block';
        modalBackdrop.onclick = closeIngredientMenu;
      }

      function closeIngredientMenu() {
          modalBackdrop.style.display = 'none';
          ingredientMenu.style.display = 'none';
      }

      function selectIngredient(itemId) {
          if (gameState.inventory[gameState.activeSlot] === null) {
              gameState.inventory[gameState.activeSlot] = { item_id: itemId };
              updateInventory();
              closeIngredientMenu();
              const itemName = getItemName(itemId);
              showToast(`æ‹¿å–äº† ${itemName}`, 'success');
          } else {
              showToast('é€™å€‹ä½ç½®å·²ç¶“æœ‰æ±è¥¿äº†!', 'error');
          }
      }

      function processActiveItem() {
          const activeItem = gameState.inventory[gameState.activeSlot];
          if (!activeItem) return;

          const recipe = recipes_v3.find(r => 
              r.requirements.length === 1 && 
              r.requirements[0].item_id_str === activeItem.item_id &&
              items_v3.find(i => i.item_id === r.output_item_id_str)?.item_tier === 1
          );

          if (!recipe) {
              showToast('é€™å€‹ç‰©å“ç„¡æ³•åœ¨é€™è£¡åŠ å·¥ã€‚');
              return;
          }

          const stationElement = document.querySelector(`[data-station-id="processing_station"]`);
          const progressBarContainer = stationElement.querySelector('.progress-bar-container');
          const progressBar = stationElement.querySelector('.progress-bar');

          gameState.isProcessing = true;
          progressBarContainer.style.display = 'block';
          
          let progress = 0;
          const processTime = (recipe.cook_time_sec || 2) * 1000;
          const interval = setInterval(() => {
              progress += 10;
              progressBar.style.width = `${(progress / processTime) * 100}%`;
              if (progress >= processTime) {
                  clearInterval(interval);
                  progressBarContainer.style.display = 'none';
                  progressBar.style.width = '0%';
                  gameState.isProcessing = false;
                  
                  gameState.inventory[gameState.activeSlot] = { item_id: recipe.output_item_id_str };
                  updateInventory();
                  const newItemName = getItemName(recipe.output_item_id_str);
                  showToast(`å®Œæˆäº† ${newItemName}!`, 'success');
              }
          }, 10);
      }

      function serveOrder(itemId) {
        const orderIndex = gameState.orders.findIndex(o => o.dish_id === itemId);
        if (orderIndex === -1) {
            showToast('é€™ä¸æ˜¯å®¢äººé»çš„èœï¼');
            return;
        }

        const servedOrder = gameState.orders[orderIndex];
        const dish = items_v3.find(i => i.item_id === servedOrder.dish_id);
        
        gameState.score += dish.base_points;
        updateScore();
        showToast(`æˆåŠŸå‡ºé¤ ${dish.item_name}ï¼`, 'success');

        gameState.inventory[gameState.activeSlot] = null;
        updateInventory();

        gameState.orders.splice(orderIndex, 1);
        updateOrders();
      }

      // ===================================
      // äº‹ä»¶è™•ç†å‡½æ•¸
      // ===================================
      function onInventorySlotClick(index) {
        const currentTime = Date.now();
        
        // æª¢æŸ¥æ˜¯å¦ç‚ºé›™æ“ŠåŒä¸€å€‹ç‰©å“æ¬„ä½
        if (index === lastClickedSlot && currentTime - lastClickTime < 300) {
            // é›™æ“Šç§»é™¤ç‰©å“
            if (gameState.inventory[index]) {
                const itemName = getItemName(gameState.inventory[index].item_id);
                gameState.inventory[index] = null;
                showToast(`ç§»é™¤äº† ${itemName}`, 'success');
                updateInventory();
            }
            // é‡ç½®é›™æ“Šæª¢æ¸¬
            lastClickedSlot = -1;
            lastClickTime = 0;
            return;
        }
        
        // è¨˜éŒ„æœ¬æ¬¡é»æ“Š
        lastClickedSlot = index;
        lastClickTime = currentTime;
        
        // åˆ‡æ› activeSlot
        gameState.activeSlot = index;

        // åˆ‡æ›çµ„åˆé¸æ“‡
        const selectionIndex = gameState.assemblySelection.indexOf(index);
        if (selectionIndex > -1) {
            // å¦‚æœå·²é¸ä¸­ï¼Œå‰‡å–æ¶ˆé¸æ“‡
            gameState.assemblySelection.splice(selectionIndex, 1);
        } else {
            // å¦‚æœæœªé¸ä¸­ï¼Œä¸”ç‰©å“ä¸ç‚ºç©ºï¼Œå‰‡åŠ å…¥é¸æ“‡
            if (gameState.inventory[index]) {
                gameState.assemblySelection.push(index);
            }
        }
        
        updateInventory();
      }

      function onStationClick(stationId) {
          if (gameState.isProcessing) return;
          console.log(`[åµéŒ¯æ—¥èªŒ] é»æ“Šäº†å·¥ä½œç«™: ${stationId}`);

          const activeItem = gameState.inventory[gameState.activeSlot];

          switch (stationId) {
              case 'ingredient_station':
                  if (!activeItem) {
                      openIngredientMenu();
                  } else {
                      showToast('æ‰‹ä¸Šå·²ç¶“æœ‰æ±è¥¿äº†ï¼Œè«‹å…ˆæ”¾ä¸‹æˆ–è™•ç†æ‰ã€‚');
                  }
                  break;
              
              case 'processing_station':
                  if (activeItem) {
                      processActiveItem();
                  } else {
                      showToast('è«‹å…ˆå¾åº«å­˜é¸æ“‡ä¸€å€‹ç‰©å“ä¾†åŠ å·¥ã€‚');
                  }
                  break;

              case 'final_assembly':
                  if (activeItem) {
                      serveOrder(activeItem.item_id);
                  } else {
                      showToast('è«‹é¸æ“‡ä¸€å€‹å®Œæˆçš„æ–™ç†ä¾†å‡ºé¤ã€‚');
                  }
                  break;

              case 'trash_can':
                  if (activeItem) {
                      const itemName = getItemName(activeItem.item_id);
                      gameState.inventory[gameState.activeSlot] = null;
                      updateInventory();
                      showToast(`ä¸Ÿæ‰äº† ${itemName}`, 'success');
                  }
                  break;
          }
      }

      function onAssembleClick() {
        if (gameState.isProcessing) return;
        if (gameState.assemblySelection.length === 0) {
            showToast('è«‹å…ˆé¸æ“‡è¦çµ„åˆçš„ç‰©å“ï¼');
            return;
        }

        const selectedItemIds = gameState.assemblySelection.map(i => gameState.inventory[i].item_id).sort();

        const recipe = recipes_v3.find(r => {
            if (r.cooking_method !== 'assembly' || !r.requirements) return false;
            const requiredItems = r.requirements.map(req => req.item_id_str).sort();
            return JSON.stringify(selectedItemIds) === JSON.stringify(requiredItems);
        });

        if (!recipe) {
            showToast('é€™ä¸æ˜¯ä¸€å€‹æœ‰æ•ˆçš„çµ„åˆï¼');
            return;
        }
        
        // çµ„åˆæˆåŠŸ
        const outputItemName = getItemName(recipe.output_item_id_str);
        showToast(`çµ„åˆæˆåŠŸï¼å¾—åˆ°äº† ${outputItemName}`, 'success');

        // æ¸…ç©ºé¸æ“‡çš„ç‰©å“
        gameState.assemblySelection.forEach(i => {
            gameState.inventory[i] = null;
        });

        // å°‡ç”¢å‡ºç‰©æ”¾å…¥ç•¶å‰ active slot
        gameState.inventory[gameState.activeSlot] = { item_id: recipe.output_item_id_str };
        
        // æ¸…ç©ºçµ„åˆå€
        gameState.assemblySelection = [];

        updateInventory();
      }

      // åˆå§‹åŒ–éŠæˆ²ç•Œé¢
      function initializeGameUI() {
        console.log('[åµéŒ¯æ—¥èªŒ] åˆå§‹åŒ–ç‰©å“æ¬„');
        initializeInventory();
        
        console.log('[åµéŒ¯æ—¥èªŒ] åˆå§‹åŒ–å·¥ä½œç«™');
        initializeStations();
        
        console.log('[åµéŒ¯æ—¥èªŒ] åˆå§‹åŒ–çµ„åˆç›¤');
        initializeAssemblyPlate();
        
        // é¡¯ç¤ºéŠæˆ²ç•Œé¢
        gameUI.style.visibility = 'visible';
        
        // å»¶é²ç”¢ç”Ÿåˆå§‹è¨‚å–®
        setTimeout(() => {
          console.log('[åµéŒ¯æ—¥èªŒ] ç”¢ç”Ÿåˆå§‹è¨‚å–®');
          generateOrder();
          generateOrder();
        }, 500);
      }

      function showLoading(message) {
        loadingScreen.style.display = 'flex';
        document.querySelector('.loading-text').textContent = message;
      }

      function hideLoading() {
        loadingScreen.style.display = 'none';
      }

      // å•Ÿå‹•éŠæˆ²åˆå§‹åŒ–æµç¨‹
      initializeGame();

      // ===================================
      // åˆå§‹åŒ–éŠæˆ²æ ¸å¿ƒå‡½æ•¸
      // ===================================
      function initializeGame() {
        console.log('[åµéŒ¯æ—¥èªŒ] é–‹å§‹åˆå§‹åŒ–éŠæˆ²...');
        
        // é¡¯ç¤ºè¼‰å…¥ä¸­
        showLoading('è¼‰å…¥éŠæˆ²è³‡æ–™ä¸­...');
        
        // è¨­å®šåˆå§‹å€’æ•¸è¨ˆæ™‚å™¨
        setupGameTimer();
        
        // è¼‰å…¥éŠæˆ²è³‡æ–™ (ç‰©å“å’Œé£Ÿè­œ)
        fetchGameData()
          .then(() => {
            console.log('[åµéŒ¯æ—¥èªŒ] éŠæˆ²è³‡æ–™è¼‰å…¥æˆåŠŸ!');
            hideLoading();
            initializeGameUI();
            
            // å•Ÿå‹•éŠæˆ²è¨ˆæ™‚å™¨
            startGameTimer();
          })
          .catch(error => {
            console.error('éŠæˆ²åˆå§‹åŒ–å¤±æ•—:', error);
            document.getElementById('error-message').textContent = 'éŠæˆ²è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯ç¹«ç®¡ç†å“¡ã€‚';
            document.getElementById('error-container').style.display = 'flex';
          });
      }

      // è¨­ç½®éŠæˆ²è¨ˆæ™‚å™¨é¡¯ç¤º
      function setupGameTimer() {
        updateTimerDisplay(gameState.time);
      }

      // æ›´æ–°è¨ˆæ™‚å™¨é¡¯ç¤º
      function updateTimerDisplay(seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        gameTimerInner.textContent = `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
      }

      // å•Ÿå‹•éŠæˆ²è¨ˆæ™‚å™¨
      function startGameTimer() {
        const gameInterval = setInterval(() => {
          gameState.time--;
          updateTimerDisplay(gameState.time);
          
          // éŠæˆ²æ™‚é–“çµæŸ
          if (gameState.time <= 0) {
            clearInterval(gameInterval);
            endGame();
          }
          
          // å®šæ™‚ç”Ÿæˆæ–°è¨‚å–®
          if (gameState.time > 0 && gameState.time % 30 === 0) {
            generateOrder();
          }
        }, 1000);
      }

      // çµæŸéŠæˆ²
      function endGame() {
        finalScore.textContent = gameState.score;
        gameOverDialog.style.display = 'flex';
      }

      // å¾å¾Œç«¯ç²å–éŠæˆ²è³‡æ–™
      async function fetchGameData() {
        try {
          const response = await fetch('/cook-api/v3/game-data', {
            method: 'GET',
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });
          
          if (!response.ok) {
            throw new Error(`API å›æ‡‰éŒ¯èª¤: ${response.status}`);
          }
          
          const data = await response.json();
          
          // è™•ç†å¾Œç«¯è³‡æ–™
          items_v3 = data.items || [];
          recipes_v3 = data.recipes || [];
          
          console.log('[åµéŒ¯æ—¥èªŒ] ç‰©å“æ•¸é‡:', items_v3.length);
          console.log('[åµéŒ¯æ—¥èªŒ] é£Ÿè­œæ•¸é‡:', recipes_v3.length);
          
        } catch (error) {
          console.error('ç²å–éŠæˆ²è³‡æ–™å¤±æ•—:', error);
          throw error;
        }
      }

      // åˆå§‹åŒ–ç‰©å“æ¬„
      function initializeInventory() {
        playerInventory.innerHTML = '';
        
        for (let i = 0; i < 8; i++) {
          const slot = document.createElement('div');
          slot.className = 'inventory-slot';
          slot.dataset.slotIndex = i;
          
          // è¨­å®šé»æ“Šäº‹ä»¶
          slot.addEventListener('click', () => onInventorySlotClick(i));
          
          playerInventory.appendChild(slot);
        }
        
        updateInventory();
      }

      // æ›´æ–°ç‰©å“æ¬„é¡¯ç¤º
      function updateInventory() {
        const slots = document.querySelectorAll('.inventory-slot');
        
        slots.forEach((slot, index) => {
          // æ¸…é™¤ä¹‹å‰çš„å…§å®¹
          slot.innerHTML = '';
          slot.classList.remove('active');
          slot.classList.remove('selected-for-assembly');
          
          // æ›´æ–°ç•¶å‰æ§½ä½ç‹€æ…‹
          const item = gameState.inventory[index];
          
          if (item) {
            const itemData = items_v3.find(i => i.item_id === item.item_id);
            if (itemData) {
              slot.textContent = itemData.ascii_symbol;
              
              // å¦‚æœæœ‰æ•¸é‡ï¼Œé¡¯ç¤ºæ•¸é‡
              if (item.quantity && item.quantity > 1) {
                const quantitySpan = document.createElement('div');
                quantitySpan.className = 'item-quantity';
                quantitySpan.textContent = item.quantity;
                slot.appendChild(quantitySpan);
              }
            }
          }
          
          // æ¨™è¨˜æ¿€æ´»çš„æ§½ä½
          if (index === gameState.activeSlot) {
            slot.classList.add('active');
          }
          
          // æ¨™è¨˜è¢«é¸ä¸­ç”¨æ–¼çµ„åˆçš„æ§½ä½
          if (gameState.assemblySelection.includes(index)) {
            slot.classList.add('selected-for-assembly');
          }
        });
      }

      // åˆå§‹åŒ–å·¥ä½œç«™
      function initializeStations() {
        stationsContainer.innerHTML = '';
        
        const stations = [
          { id: 'ingredient_station', name: 'é£Ÿæå€', icon: 'ğŸ¥—' },
          { id: 'processing_station', name: 'åŠ å·¥å€', icon: 'ğŸ³' },
          { id: 'final_assembly', name: 'å‡ºé¤å€', icon: 'ğŸ§‘â€ğŸ³' },
          { id: 'trash_can', name: 'åƒåœ¾æ¡¶', icon: 'ğŸ—‘ï¸' }
        ];
        
        stations.forEach(station => {
          const stationDiv = document.createElement('div');
          stationDiv.className = 'station';
          stationDiv.dataset.stationId = station.id;
          
          stationDiv.innerHTML = `
            <div class="station-icon">${station.icon}</div>
            <div class="station-label">${station.name}</div>
            <div class="progress-bar-container">
              <div class="progress-bar"></div>
            </div>
          `;
          
          stationDiv.addEventListener('click', () => onStationClick(station.id));
          
          stationsContainer.appendChild(stationDiv);
        });
      }

      // åˆå§‹åŒ–çµ„åˆç›¤
      function initializeAssemblyPlate() {
        assemblySlotsContainer.innerHTML = '';
        
        // å»ºç«‹3å€‹çµ„åˆæ§½ä½
        for (let i = 0; i < 3; i++) {
          if (i > 0) {
            const operator = document.createElement('div');
            operator.className = 'plate-operator';
            operator.textContent = '+';
            assemblySlotsContainer.appendChild(operator);
          }
          
          const slot = document.createElement('div');
          slot.className = 'plate-slot';
          slot.dataset.plateIndex = i;
          assemblySlotsContainer.appendChild(slot);
        }
        
        // è¨­å®šçµ„åˆæŒ‰éˆ•äº‹ä»¶
        assembleBtn.addEventListener('click', onAssembleClick);
      }

      // æ›´æ–°çµ„åˆç›¤é¡¯ç¤º
      function updateAssemblyPlate() {
        // æœªå¯¦ç¾ï¼Œå°‡åœ¨å¾ŒçºŒç‰ˆæœ¬æ·»åŠ 
      }

      // ç”Ÿæˆéš¨æ©Ÿè¨‚å–®
      function generateOrder() {
        // ç¢ºä¿ä¸è¶…éæœ€å¤§è¨‚å–®æ•¸
        if (gameState.orders.length >= 3) return;
        
        // å¾T2ç‰©å“ä¸­éš¨æ©Ÿé¸æ“‡ä¸€å€‹ä½œç‚ºè¨‚å–®
        const finalDishes = items_v3.filter(item => item.item_tier === 2);
        if (!finalDishes.length) return;
        
        const randomDish = finalDishes[Math.floor(Math.random() * finalDishes.length)];
        
        // å‰µå»ºæ–°è¨‚å–®
        const newOrder = {
          id: Date.now(),
          dish_id: randomDish.item_id,
          dish_name: randomDish.item_name,
          points: randomDish.base_points,
          timeLeft: 120, // 120ç§’å®Œæˆæ™‚é–“
          ingredients: [] // éœ€è¦é¡¯ç¤ºçš„åŸæ–™
        };
        
        // æŸ¥æ‰¾è£½ä½œæ­¤æ–™ç†æ‰€éœ€çš„é£Ÿè­œ
        const recipe = recipes_v3.find(r => r.output_item_id_str === randomDish.item_id);
        if (recipe && recipe.requirements) {
          // æ·»åŠ éœ€è¦çš„åŸæ–™
          newOrder.ingredients = recipe.requirements.map(req => {
            const ingredientItem = items_v3.find(i => i.item_id === req.item_id_str);
            return {
              id: req.item_id_str,
              name: ingredientItem ? ingredientItem.item_name : 'æœªçŸ¥ç‰©å“',
              icon: ingredientItem ? ingredientItem.ascii_symbol : 'â“',
              quantity: req.quantity
            };
          });
        }
        
        // æ·»åŠ åˆ°è¨‚å–®åˆ—è¡¨
        gameState.orders.push(newOrder);
        
        // æ›´æ–°è¨‚å–®é¡¯ç¤º
        updateOrders();
        
        // é¡¯ç¤ºæç¤º
        showToast(`æ”¶åˆ°æ–°è¨‚å–®ï¼š${newOrder.dish_name}!`, 'info');
      }

      // æ›´æ–°è¨‚å–®é¡¯ç¤º
      function updateOrders() {
        ordersContainer.innerHTML = '';
        
        if (gameState.orders.length === 0) {
          ordersContainer.innerHTML = '<div style="text-align: center; color: #8b949e; padding: 20px;">æš«ç„¡è¨‚å–®</div>';
          return;
        }
        
        gameState.orders.forEach(order => {
          const orderCard = document.createElement('div');
          orderCard.className = 'order-card';
          
          let ingredientsHTML = '';
          order.ingredients.forEach(ing => {
            ingredientsHTML += `
              <div class="order-ingredient-item">
                <span class="order-ingredient-icon">${ing.icon}</span>
                ${ing.name} x${ing.quantity}
              </div>
            `;
          });
          
          // è¨ˆç®—æ™‚é–“ç™¾åˆ†æ¯”
          const timePercentage = Math.min(100, (order.timeLeft / 120) * 100);
          
          orderCard.innerHTML = `
            <div class="order-name">${order.dish_name}</div>
            <div class="order-ingredients">${ingredientsHTML}</div>
            <div class="order-timer-container">
              <div class="order-timer-text">å‰©é¤˜æ™‚é–“: ${order.timeLeft}ç§’</div>
              <div class="order-timer">
                <div class="order-timer-fill" style="width: ${timePercentage}%"></div>
              </div>
            </div>
          `;
          
          ordersContainer.appendChild(orderCard);
        });
      }

      // æ›´æ–°åˆ†æ•¸é¡¯ç¤º
      function updateScore() {
        gameScore.textContent = `åˆ†æ•¸: ${gameState.score}`;
      }

      // è¿”å›å¤§å»³äº‹ä»¶
      returnToLobbyBtn.addEventListener('click', () => {
        window.location.href = 'cook-lobby.html';
      });

    });
  </script>
</body>
</html>