<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>料理急先鋒 V3 - 完整版</title>
    <!-- 引入 Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- 引入 Element Plus -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css" />
    <script src="https://unpkg.com/element-plus"></script>
    <!-- 引入動畫效果庫 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <!-- 引入拖拽庫 (已被移除) -->
    
    <!-- 自定義樣式 -->
    <link rel="stylesheet" href="./css/cooking-game.css">
</head>
<body>
    <!-- User Status Indicator -->
    <div id="userStatus" class="user-status">
        <img id="userStatusAvatar" src="/images/a01girlmove.gif" alt="User">
        <span id="userStatusName" class="username">未登入</span>
    </div>

    <div id="cooking-game">
        <!-- Vue 應用將在此掛載 -->
    </div>
    
    <!-- 確保使用 type="module" 屬性 -->
    <script type="module" src="./js/cooking-game.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // User status elements
            const userStatusAvatar = document.getElementById('userStatusAvatar');
            const userStatusName = document.getElementById('userStatusName');
            const userStatus = document.getElementById('userStatus');

            // 檢查是否有已保存的登入信息
            const savedUserId = localStorage.getItem('boxCurrentUserId');
            const savedUserToken = localStorage.getItem(`boxUserToken_${savedUserId}`);
            const savedUserAvatarUrl = localStorage.getItem('boxCurrentUserAvatar');
            const savedUserName = localStorage.getItem('boxCurrentUsername');
            const savedDisplayName = localStorage.getItem('boxCurrentDisplayName') || savedUserName;

            // Update the user status indicator
            if (savedUserId && savedUserToken && savedUserName) {
                userStatusAvatar.src = savedUserAvatarUrl || '/images/a01girlmove.gif';
                userStatusName.textContent = savedDisplayName;
                
                // Add click event to navigate to user editor page
                userStatus.addEventListener('click', () => {
                    window.location.href = `/member-editor.html?userId=${savedUserId}`;
                });
            } else {
                userStatusAvatar.src = '/images/a01girlmove.gif';
                userStatusName.textContent = '未登入';
                userStatus.addEventListener('click', () => {
                    // 變更為導向會員登入頁
                    window.location.href = `/member-login.html?redirect=${encodeURIComponent(window.location.href)}`;
                });
            }
        });
    </script>
</body>
</html>