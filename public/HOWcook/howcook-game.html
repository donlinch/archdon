<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£Ÿè­œæ¯”å°ç³»çµ±</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Microsoft JhengHei', 'SF Pro Text', 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
            background-color: #f9f5f0;
            color: #333;
            font-size: 16px;
        }
        h1 {
            color: #8b4513;
            text-align: center;
            padding: 10px 0;
            font-size: 1.5rem;
        }
        .input-section {
            margin-bottom: 15px;
            background-color: #fff;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .input-title {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        .recipe-challenge {
            padding: 10px;
            background-color: #fff9e6;
            border-radius: 5px;
            border: 1px solid #d2b48c;
        }
        .recipe-description {
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #5a3921;
        }
        .recipe-tips {
            font-size: 0.9rem;
            font-style: italic;
            color: #8b6b4f;
        }
        
        /* æ–°å¢ï¼šç¨‹å¼ç¢¼çµ„åˆä»‹é¢æ¨£å¼ */
        .code-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .code-preview {
            flex: 1;
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', Courier, monospace;
            min-height: 200px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
            overflow-y: auto;
            border: 1px solid #444;
        }
        .code-line {
            margin: 8px 0;
            padding: 5px 8px;
            border-left: 4px solid;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: #3a3a3a;
            border-radius: 0 4px 4px 0;
        }
        .code-line:first-child {
            margin-top: 0;
        }
        .code-palette {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .category-filter {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }
        .filter-btn {
            flex: 1;
            padding: 8px 10px;
            border: 1px solid #d2b48c;
            background-color: #f0e6d2;
            color: #5a3921;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .filter-btn.active, .filter-btn:hover {
            background-color: #8b4513;
            color: white;
            border-color: #5a3921;
        }
        .code-options {
            background: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            overflow-y: auto;
            max-height: 250px;
        }
        .code-option {
            background: #49483e;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: transform 0.2s;
        }
        .code-option:hover {
            transform: scale(1.05);
        }
        /* æŒ‰é¡å‹å€åˆ†é¡è‰² */
        .code-line[data-type="ingredient"] { border-color: #a6e22e; } /* ç¶ è‰² - é£Ÿæ */
        .code-line[data-type="action"] { border-color: #f92672; } /* ç²‰è‰² - æ“ä½œ */
        .code-line[data-type="tool"] { border-color: #66d9ef; } /* è—è‰² - å·¥å…· */
        .code-line[data-type="seasoning"] { border-color: #fd971f; } /* æ©˜è‰² - èª¿å‘³æ–™ */

        .result-container {
            margin-top: 15px;
            padding: 15px;
            background-color: #fff9e6;
            border: 1px dashed #d2b48c;
            border-radius: 10px;
        }
        .recipe-sentence {
            line-height: 1.6;
            color: #5a3921;
            margin-bottom: 10px;
            white-space: pre-wrap; /* ç‚ºäº†é¡¯ç¤ºæ›è¡Œ */
        }
        .ai-prompt {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9rem;
            margin-top: 10px;
            word-break: break-word;
            white-space: pre-wrap;
        }
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
        }
        .action-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s;
            flex-basis: 200px;
            flex-grow: 0;
        }
        .run-btn {
            background-color: #4CAF50;
            color: white;
        }
        .run-btn:hover {
            background-color: #45a049;
        }
        .reset-btn {
            background-color: #d2b48c;
            color: white;
        }
        .reset-btn:hover {
            background-color: #8b4513;
        }
        .emoji {
            font-size: 1.2rem;
            margin-right: 5px;
            vertical-align: middle;
        }
        .score-display {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 15px 0;
            color: #8b4513;
        }
    </style>
</head>
<body>
    <h1><span class="emoji">ğŸ³</span>é£Ÿè­œç¨‹å¼è¨­è¨ˆ</h1>
    
    <div class="input-section">
        <div class="input-title">ä»Šæ—¥æŒ‘æˆ°é¡Œç›®</div>
        <div class="recipe-challenge">
            <div class="recipe-description" id="recipeDescription"></div>
            <div class="recipe-tips" id="recipeTips"></div>
        </div>
    </div>
    
    <div class="code-container">
        <!-- æŒ‡ä»¤å †ç–Šå€ -->
        <div class="code-preview" id="codePreview">
            <div class="code-line" id="initialMessage">// é»æ“Šå³å´æŒ‡ä»¤é–‹å§‹çµ„åˆ...</div>
        </div>
        
        <!-- è‡ªç”±é¸æ“‡é¢æ¿ -->
        <div class="code-palette">
            <div class="category-filter">
                <button class="filter-btn active" data-category="all">å…¨éƒ¨</button>
                <button class="filter-btn" data-category="ingredient">é£Ÿæ</button>
                <button class="filter-btn" data-category="action">æ“ä½œ</button>
                <button class="filter-btn" data-category="seasoning">èª¿å‘³</button>
                <button class="filter-btn" data-category="tool">å·¥å…·</button>
            </div>
            
            <div class="code-options" id="codeOptions">
                <!-- å‹•æ…‹ç”Ÿæˆçš„é¸é …æŒ‰éˆ• -->
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <button class="action-btn reset-btn" id="changeQuestionBtn">æ›ä¸€é¡Œ</button>
        <button class="action-btn run-btn" id="runCode">
            <span class="emoji">âš¡</span> åŸ·è¡Œæ–™ç†
        </button>
    </div>
    
    <!-- çµæœé¡¯ç¤ºå€ -->
    <div class="result-container" id="resultContainer">
        <div class="score-display" id="scoreDisplay">ç›¸ä¼¼åº¦è©•åˆ†: -</div>
        <div class="recipe-sentence" id="recipeResult">çµ„åˆä½ çš„æ–™ç†ç¨‹å¼ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒåŸ·è¡Œæ–™ç†ã€ä¾†çœ‹çœ‹çµæœï¼</div>
        <div class="ai-prompt" id="aiPrompt"></div>
        <button class="action-btn copy-btn" id="copyBtn" style="display:none;">è¤‡è£½åˆ†ææç¤ºè©</button>
    </div>

    <script>
        const recipeQuestions = [
            {
                "title": "åå¸æœé†¬",
                "description": "æŒ‘æˆ°ï¼šè£½ä½œä¸€ä»½é£½è¶³æ„Ÿçš„æ‡¶äººå¿«é€Ÿç‡Ÿé¤Šæ—©é¤ï¼Œ2 åˆ†é˜æå®šã€‚",
                "ingredients": ["åå¸", "æœé†¬"],
                "actions": ["çƒ¤"],
                "seasonings": [],
                "tools": ["éºµåŒ…æ©Ÿ"],
                "tips": "åå¸å¯æ–¼è¶…å¸‚è³¼è²·ï¼Œä¿è³ªæœŸè¼ƒçŸ­ã€‚ç”¨é¤å·¾ç´™åŒ…è‘—å¯ä»¥é‚Šèµ°é‚Šåƒã€‚"
            },
            {
                "title": "å¾®æ³¢çˆè·åŒ…è›‹",
                "description": "æŒ‘æˆ°ï¼šè£½ä½œä¸€é“ç°¡å–®æ˜“åšä¸”å¯Œå«è›‹ç™½è³ªçš„èœé¤šï¼Œ120ç§’å…§å³å¯å®Œæˆã€‚",
                "ingredients": ["é›è›‹", "é£²ç”¨æ°´"],
                "actions": ["å¾®æ³¢"],
                "seasonings": ["èŠéº»æ²¹", "é¹½"],
                "tools": ["å¾®æ³¢çˆ", "å°ç¢—"],
                "tips": "ç‚ºé¿å…åŠ ç†±æ™‚è›‹é»ƒæ¿ºå‡ºï¼Œå¯ä»¥åœ¨ç¢—ä¸ŠåŠ è“‹ã€‚ç”¨ç­·å­åœ¨è›‹é»ƒä¸Šæˆ³å¹¾å€‹æ´æ˜¯é—œéµï¼"
            }
        ];
        
        const codeLibrary = {
            ingredients: [
                { emoji: "ğŸ”", name: "é›è‚‰" }, { emoji: "ğŸ·", name: "è±¬è‚‰" }, { emoji: "ğŸ®", name: "ç‰›è‚‰" },
                { emoji: "ğŸŸ", name: "é­šè‚‰" }, { emoji: "ğŸ¦", name: "è¦" }, { emoji: "ğŸ¥š", name: "é›è›‹" },
                { emoji: "ğŸ¥”", name: "é¦¬éˆ´è–¯" }, { emoji: "ğŸ¥¬", name: "é«˜éº—èœ" }, { emoji: "ğŸ§…", name: "æ´‹è”¥" },
                { emoji: "ğŸ¥•", name: "ç´…è˜¿è””" }, { emoji: "ğŸš", name: "ç±³é£¯" }, { emoji: "ğŸœ", name: "éºµæ¢" },
                { emoji: "ğŸ", name: "åå¸" }, { emoji: "ğŸ’§", name: "é£²ç”¨æ°´" }, { emoji: "ğŸ“", name: "æœé†¬" },
            ],
            actions: [
                { emoji: "ğŸ”ª", name: "åˆ‡å¡Š", requires: "ingredient" }, { emoji: "ğŸ³", name: "ç‚’", requires: ["ingredient", "tool"] },
                { emoji: "ğŸ³", name: "ç…", requires: ["ingredient", "tool"] }, { emoji: "ğŸ”¥", name: "ç‚¸", requires: ["ingredient", "tool"] },
                { emoji: "ğŸ’¨", name: "è’¸", requires: ["ingredient", "tool"] }, { emoji: "ğŸ²", name: "ç…®", requires: ["ingredient", "tool"] },
                { emoji: "ğŸ”¥", name: "çƒ¤", requires: ["ingredient", "tool"] }, { emoji: "â™¨ï¸", name: "å¾®æ³¢", requires: ["ingredient", "tool"] },
                { emoji: "ğŸ¥£", name: "æ¶¼æ‹Œ", requires: "ingredient" }, { emoji: "ğŸ¥£", name: "é†ƒè£½", requires: ["ingredient", "seasoning"] }
            ],
            seasonings: [
                { emoji: "ğŸ§‚", name: "é¹½" }, { emoji: "âš«", name: "é»‘èƒ¡æ¤’" }, { emoji: "âšª", name: "ç™½èƒ¡æ¤’" },
                { emoji: "ğŸ¬", name: "ç³–" }, { emoji: "ğŸ¶", name: "é†¬æ²¹" }, { emoji: "ğŸ‡", name: "é†‹" },
                { emoji: "ğŸ¥ƒ", name: "ç±³é…’" }, { emoji: "ğŸ’§", name: "é¦™æ²¹" }, { emoji: "ğŸ’§", name: "èŠéº»æ²¹" },
                { emoji: "ğŸ«’", name: "æ©„æ¬–æ²¹" }, { emoji: "ğŸ¥«", name: "ç•ªèŒ„é†¬" }, { emoji: "ğŸŒ¶ï¸", name: "è¾£æ¤’ç²‰" }
            ],
            tools: [
                { emoji: "ğŸ³", name: "ç‚’é‹" }, { emoji: "ğŸ³", name: "å¹³åº•é‹" }, { emoji: "ğŸ²", name: "æ¹¯é‹" },
                { emoji: "ğŸ”¥", name: "çƒ¤ç®±" }, { emoji: "ğŸš", name: "é›»é‹" }, { emoji: "â™¨ï¸", name: "å¾®æ³¢çˆ" },
                { emoji: "ğŸ", name: "éºµåŒ…æ©Ÿ" }, { emoji: "ğŸ¥£", name: "å°ç¢—" }, { emoji: "ğŸ¥¢", name: "ç­·å­" }
            ]
        };

        let currentQuestion = null;
        let codeStack = [];

        document.addEventListener('DOMContentLoaded', function() {
            initPalette();
            showRandomQuestion();

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => handleFilterClick(btn));
            });

            document.getElementById('changeQuestionBtn').addEventListener('click', showRandomQuestion);
            document.getElementById('runCode').addEventListener('click', handleRunClick);
            
            document.getElementById('copyBtn').addEventListener('click', function() {
                copyToClipboard(document.getElementById('aiPrompt').textContent);
                this.textContent = 'å·²è¤‡è£½ï¼';
                setTimeout(() => {
                    this.textContent = 'è¤‡è£½åˆ†ææç¤ºè©';
                }, 2000);
            });
        });

        function initPalette() {
            const container = document.getElementById('codeOptions');
            container.innerHTML = '';
            for (const category in codeLibrary) {
                codeLibrary[category].forEach(item => {
                    const btn = document.createElement('button');
                    btn.className = 'code-option';
                    btn.dataset.category = category;
                    btn.innerHTML = `<span class="emoji">${item.emoji}</span> ${item.name}`;
                    btn.addEventListener('click', () => handleOptionClick(item, category));
                    container.appendChild(btn);
                });
            }
        }

        function handleFilterClick(clickedBtn) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            clickedBtn.classList.add('active');
            const category = clickedBtn.dataset.category;
            
            document.querySelectorAll('.code-option').forEach(option => {
                if (category === 'all' || option.dataset.category === category) {
                    option.style.display = 'flex';
                } else {
                    option.style.display = 'none';
                }
            });
        }

        function handleOptionClick(item, category) {
            // ç§»é™¤åˆå§‹è¨Šæ¯
            const initialMessage = document.getElementById('initialMessage');
            if (initialMessage) {
                initialMessage.remove();
            }
            
            codeStack.push({ ...item, type: category.slice(0, -1) }); // e.g., ingredients -> ingredient
            updateCodePreview();
        }

        function updateCodePreview() {
            const preview = document.getElementById('codePreview');
            preview.innerHTML = '';
            if (codeStack.length === 0) {
                 preview.innerHTML = '<div class="code-line" id="initialMessage">// é»æ“Šå³å´æŒ‡ä»¤é–‹å§‹çµ„åˆ...</div>';
                 return;
            }
            codeStack.forEach((line, index) => {
                const lineDiv = document.createElement('div');
                lineDiv.className = 'code-line';
                lineDiv.dataset.type = line.type;
                lineDiv.innerHTML = `<span class="emoji">${line.emoji}</span> ${line.name}`;
                preview.appendChild(lineDiv);
            });
        }
        
        function showRandomQuestion() {
            const randomIndex = Math.floor(Math.random() * recipeQuestions.length);
            currentQuestion = recipeQuestions[randomIndex];
            
            document.getElementById('recipeDescription').textContent = currentQuestion.description;
            document.getElementById('recipeTips').textContent = `å°è²¼å£«ï¼š${currentQuestion.tips}`;
            
            resetAll();
        }

        function resetAll() {
            codeStack = [];
            updateCodePreview();
            document.getElementById('scoreDisplay').textContent = 'ç›¸ä¼¼åº¦è©•åˆ†: -';
            document.getElementById('recipeResult').textContent = 'çµ„åˆä½ çš„æ–™ç†ç¨‹å¼ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒåŸ·è¡Œæ–™ç†ã€ä¾†çœ‹çœ‹çµæœï¼';
            document.getElementById('aiPrompt').textContent = '';
            document.getElementById('copyBtn').style.display = 'none';
        }

        function handleRunClick() {
            const { isValid, feedback } = validateCodeStack();
            
            if (!isValid) {
                document.getElementById('scoreDisplay').textContent = "ç¨‹å¼ç¢¼éŒ¯èª¤ï¼";
                document.getElementById('recipeResult').textContent = feedback;
                document.getElementById('aiPrompt').textContent = '';
                document.getElementById('copyBtn').style.display = 'none';
                return;
            }

            const score = calculateScore();
            document.getElementById('scoreDisplay').textContent = `ç›¸ä¼¼åº¦è©•åˆ†: ${score}/100`;

            const recipeText = generateRecipe();
            document.getElementById('recipeResult').textContent = recipeText;

            const aiPrompt = generateAIPrompt();
            document.getElementById('aiPrompt').textContent = aiPrompt;
            document.getElementById('copyBtn').style.display = 'block';
        }

        function validateCodeStack() {
            if (codeStack.length === 0) {
                return { isValid: false, feedback: "éŒ¯èª¤ï¼šæ–™ç†ç¨‹å¼ç¢¼æ˜¯ç©ºçš„ï¼è«‹å…ˆåŠ å…¥æŒ‡ä»¤ã€‚" };
            }
            
            const has = {
                ingredient: codeStack.some(l => l.type === 'ingredient'),
                action: codeStack.some(l => l.type === 'action'),
                tool: codeStack.some(l => l.type === 'tool')
            };

            if (!has.ingredient) {
                return { isValid: false, feedback: "éŒ¯èª¤ï¼šä½ æ²’æœ‰æº–å‚™ä»»ä½•é£Ÿæï¼" };
            }
            if (!has.action) {
                return { isValid: false, feedback: "éŒ¯èª¤ï¼šä½ æ²’æœ‰åŸ·è¡Œä»»ä½•çƒ¹é£ªæ“ä½œï¼" };
            }
            if (!has.tool) {
                return { isValid: false, feedback: "éŒ¯èª¤ï¼šä½ æ²’æœ‰ä½¿ç”¨ä»»ä½•å»šå…·ï¼" };
            }

            for (let i = 0; i < codeStack.length; i++) {
                const line = codeStack[i];
                if (line.type === 'action' && line.requires) {
                    const requirements = Array.isArray(line.requires) ? line.requires : [line.requires];
                    const stackBefore = codeStack.slice(0, i);
                    
                    for (const req of requirements) {
                        if (!stackBefore.some(l => l.type === req)) {
                            return { 
                                isValid: false, 
                                feedback: `éŒ¯èª¤ï¼šæŒ‡ä»¤ "${line.name}" éœ€è¦å…ˆæº–å‚™ "${req}" é¡å‹çš„æŒ‡ä»¤ã€‚`
                            };
                        }
                    }
                }
            }

            return { isValid: true, feedback: "ç¨‹å¼ç¢¼çœ‹èµ·ä¾†å¾ˆæ£’ï¼" };
        }

        function calculateScore() {
            let score = 0;
            const userSelections = {
                ingredients: new Set(codeStack.filter(l => l.type === 'ingredient').map(l => l.name)),
                actions: new Set(codeStack.filter(l => l.type === 'action').map(l => l.name)),
                seasonings: new Set(codeStack.filter(l => l.type === 'seasoning').map(l => l.name)),
                tools: new Set(codeStack.filter(l => l.type === 'tool').map(l => l.name))
            };

            const answer = {
                ingredients: new Set(currentQuestion.ingredients),
                actions: new Set(currentQuestion.actions),
                seasonings: new Set(currentQuestion.seasonings),
                tools: new Set(currentQuestion.tools)
            };

            // åˆ†æ•¸æ¬Šé‡
            const weights = { ingredients: 40, actions: 30, tools: 20, seasonings: 10 };

            for (const category in userSelections) {
                const userItems = userSelections[category];
                const answerItems = answer[category];
                
                if (answerItems.size === 0) {
                    // å¦‚æœç­”æ¡ˆä¸éœ€è¦æ­¤é¡åˆ¥ (ä¾‹å¦‚èª¿å‘³æ–™)
                    score += (userItems.size === 0) ? weights[category] : 0;
                    continue;
                }

                let correctMatches = 0;
                userItems.forEach(item => {
                    if (answerItems.has(item)) {
                        correctMatches++;
                    }
                });
                
                // åˆ†æ•¸è¨ˆç®—: (æ­£ç¢ºæ•¸ / ç­”æ¡ˆéœ€æ±‚æ•¸) * æ¬Šé‡ï¼Œä½†ä¸è¶…éæ¬Šé‡
                const categoryScore = Math.min(weights[category], (correctMatches / answerItems.size) * weights[category]);
                score += categoryScore;
            }
            
            return Math.round(score);
        }

        function generateRecipe() {
            let recipe = "## æ‚¨çš„å‰µæ„æ–™ç†æµç¨‹\n\n";
            codeStack.forEach((line, index) => {
                recipe += `${index + 1}. ${line.emoji} åŸ·è¡ŒæŒ‡ä»¤: ${line.name}\n`;
                switch(line.type) {
                    case "ingredient":
                        recipe += `   - [æº–å‚™é£Ÿæ] å°‡ ${line.name} æ”¾åˆ°æ–™ç†å°ä¸Šã€‚\n`;
                        break;
                    case "seasoning":
                        recipe += `   - [æ·»åŠ é¢¨å‘³] ä½¿ç”¨ ${line.name} é€²è¡Œèª¿å‘³ã€‚\n`;
                        break;

                    case "action":
                        recipe += `   - [åŸ·è¡Œæ“ä½œ] å°é£ŸæåŸ·è¡Œã€Œ${line.name}ã€æ“ä½œã€‚\n`;
                        break;
                    case "tool":
                        recipe += `   - [é¸ç”¨å·¥å…·] æ‹¿å‡º ${line.name} æº–å‚™ä½¿ç”¨ã€‚\n`;
                        break;
                }
            });
            return recipe;
        }

        function generateAIPrompt() {
            let prompt = `è«‹æ ¹æ“šä»¥ä¸‹é£Ÿè­œæŒ‘æˆ°å’Œç”¨æˆ¶æäº¤çš„ã€Œæ–™ç†ç¨‹å¼ç¢¼ã€ï¼Œé€²è¡Œè©³ç´°æ¯”å°åˆ†æã€‚\n\n`;
            
            prompt += 'ã€é¡Œç›®è¦æ±‚ã€‘\n';
            prompt += `æè¿°ï¼š${currentQuestion.description}\n`;
            prompt += `æç¤ºï¼š${currentQuestion.tips}\n\n`;
            
            prompt += 'ã€æ­£ç¢ºç­”æ¡ˆåƒè€ƒã€‘\n';
            prompt += `- é£Ÿæ: ${currentQuestion.ingredients.join('ã€') || 'ç„¡'}\n`;
            prompt += `- æ“ä½œ: ${currentQuestion.actions.join('ã€') || 'ç„¡'}\n`;
            prompt += `- èª¿å‘³æ–™: ${currentQuestion.seasonings.join('ã€') || 'ç„¡'}\n`;
            prompt += `- å·¥å…·: ${currentQuestion.tools.join('ã€') || 'ç„¡'}\n\n`;

            prompt += 'ã€ç”¨æˆ¶çš„æ–™ç†ç¨‹å¼ç¢¼ã€‘\n';
            codeStack.forEach((line, index) => {
                prompt += `${index + 1}. [${line.type}] ${line.name}\n`;
            });

            prompt += '\nã€æ¯”å°è¦æ±‚ã€‘\n';
            prompt += '1. åˆ†æä¸»è¦å·®ç•°é»ï¼ˆä»¥è¡¨æ ¼å‘ˆç¾ï¼ŒåŒ…å«ï¼šæ¯”å°é …ç›®ã€æ­£ç¢ºç­”æ¡ˆã€ç”¨æˆ¶é¸æ“‡ã€å·®ç•°èªªæ˜ï¼‰\n';
            prompt += '2. æä¾›å…·é«”æ”¹é€²å»ºè­°ï¼ˆå¦‚ä½•èª¿æ•´æŒ‡ä»¤é †åºæˆ–æ›¿æ›æŒ‡ä»¤èƒ½æ›´æ¥è¿‘æ­£ç¢ºç­”æ¡ˆï¼‰\n';
            prompt += '3. æ ¹æ“šç”¨æˆ¶çš„æŒ‡ä»¤çµ„åˆï¼Œé æ¸¬æœ€çµ‚æˆå“çš„å‘³é“å’Œå£æ„Ÿï¼Œä¸¦çµ¦å‡ºå‰µæ„é»è©•ã€‚\n';
            prompt += '4. å¦‚æœçµ„åˆéå¸¸å¥‡ç‰¹ï¼Œè«‹ä»¥é¼“å‹µçš„èªæ°£æå‡ºå‰µæ–°æ–™ç†çš„å¯èƒ½æ€§ã€‚\n';
            prompt += '5. æœ€å¾Œç¸½çµè©•èªï¼ˆç°¡çŸ­æœ‰åŠ›çš„çµè«–ï¼‰ã€‚';
            
            return prompt;
        }

        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
    </script>
</body>
</html>