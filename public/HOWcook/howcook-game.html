<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£Ÿè­œç¨‹å¼è¨­è¨ˆéŠæˆ²</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Microsoft JhengHei', 'SF Pro Text', 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
            background-color: #f9f5f0;
            color: #333;
            font-size: 16px;
        }
        h1 {
            color: #8b4513;
            text-align: center;
            padding: 10px 0;
            font-size: 1.5rem;
        }
        .input-section {
            margin-bottom: 15px;
            background-color: #fff;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .input-title {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        .recipe-challenge {
            padding: 10px;
            background-color: #fff9e6;
            border-radius: 5px;
            border: 1px solid #d2b48c;
        }
        .recipe-description {
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #5a3921;
        }
        .recipe-tips {
            font-size: 0.9rem;
            font-style: italic;
            color: #8b6b4f;
        }
        
        /* ç¨‹å¼ç¢¼çµ„åˆä»‹é¢æ¨£å¼ */
        .code-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .code-preview {
            flex: 1;
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', Courier, monospace;
            min-height: 200px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
            overflow-y: auto;
            border: 1px solid #444;
        }
        .code-line {
            margin: 8px 0;
            padding: 5px 8px;
            border-left: 4px solid;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: #3a3a3a;
            border-radius: 0 4px 4px 0;
            position: relative;
        }
        .code-line-group {
            margin: 15px 0;
            padding: 10px;
            border-left: 2px dashed #666;
            background-color: rgba(255,255,255,0.05);
            border-radius: 5px;
            position: relative;
        }
        .code-line:first-child {
            margin-top: 0;
        }
        .code-line .delete-btn {
            margin-left: auto;
            background: #ff5555;
            color: white;
            border: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .code-line:hover .delete-btn {
            opacity: 1;
        }
        .code-palette {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 300px;
        }
        .category-filter {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        .filter-btn {
            padding: 8px 12px;
            border: 1px solid #d2b48c;
            background-color: #f0e6d2;
            color: #5a3921;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        .filter-btn.active, .filter-btn:hover {
            background-color: #8b4513;
            color: white;
            border-color: #5a3921;
        }
        .code-options {
            background: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            overflow-y: auto;
            max-height: 250px;
        }
        .code-option {
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        .code-option:hover:not(:disabled) {
            transform: scale(1.05);
        }
        .code-option:disabled {
            background-color: #555;
            cursor: not-allowed;
            opacity: 0.5;
        }
        /* æŒ‰é¡å‹å€åˆ†é¡è‰² */
        .code-line[data-type="ingredient"],
        .code-option[data-category="ingredients"] { 
            border-color: #a6e22e;
            background-color: #3c4a36;
        }
        .code-line[data-type="action"],
        .code-option[data-category="actions"] { 
            border-color: #f92672;
            background-color: #4a2a38;
        }
        .code-line[data-type="tool"],
        .code-option[data-category="tools"] { 
            border-color: #66d9ef;
            background-color: #2d4a52;
        }
        .code-line[data-type="seasoning"],
        .code-option[data-category="seasonings"] { 
            border-color: #fd971f;
            background-color: #4a3c2a;
        }
        .code-line[data-type="processed"] { 
            border-color: #ae81ff;
            background-color: #3a2d4a;
            margin-top:10px;
        }
        .combine-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: #ae81ff;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        .combine-btn:hover {
            background-color: #9966ff;
        }

        .result-container {
            margin-top: 15px;
            padding: 15px;
            background-color: #fff9e6;
            border: 1px dashed #d2b48c;
            border-radius: 10px;
        }
        .recipe-sentence {
            line-height: 1.6;
            color: #5a3921;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }
        .ai-prompt {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9rem;
            margin-top: 10px;
            word-break: break-word;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .action-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s;
            flex-grow: 1;
            max-width: 200px;
        }
        .run-btn {
            background-color: #4CAF50;
            color: white;
        }
        .run-btn:hover {
            background-color: #45a049;
        }
        .reset-btn {
            background-color: #d2b48c;
            color: white;
        }
        .reset-btn:hover {
            background-color: #8b4513;
        }
        .new-group-btn {
            background-color: #6b8bff;
            color: white;
        }
        .new-group-btn:hover {
            background-color: #5a79e0;
        }
        .emoji {
            font-size: 1.2rem;
            margin-right: 5px;
            vertical-align: middle;
        }
        .score-display {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 15px 0;
            color: #8b4513;
        }
        .diff-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .diff-table th, .diff-table td {
            border: 1px solid #d2b48c;
            padding: 8px;
            text-align: left;
        }
        .diff-table th {
            background-color: #f0e6d2;
        }
    </style>
</head>
<body>
    <h1><span class="emoji">ğŸ³</span>æ–™ç†ç¨‹å¼è¨­è¨ˆéŠæˆ²</h1>
    
    <div class="input-section">
        <div class="input-title">ä»Šæ—¥æŒ‘æˆ°é¡Œç›®</div>
        <div class="recipe-challenge">
            <div class="recipe-description" id="recipeDescription"></div>
            <div class="recipe-tips" id="recipeTips"></div>
        </div>
    </div>
    
    <div class="code-container">
        <!-- æŒ‡ä»¤å †ç–Šå€ -->
        <div class="code-preview" id="codePreview">
            <div class="code-line" id="initialMessage">// é»æ“Šå³å´æŒ‡ä»¤é–‹å§‹çµ„åˆ...</div>
        </div>
        
        <!-- è‡ªç”±é¸æ“‡é¢æ¿ -->
        <div class="code-palette">
            <div class="category-filter">
                <button class="filter-btn active" data-category="all">å…¨éƒ¨</button>
                <button class="filter-btn" data-category="combined">çµ„åˆ</button>
                <button class="filter-btn" data-category="ingredients">é£Ÿæ</button>
                <button class="filter-btn" data-category="actions">æ“ä½œ</button>
                <button class="filter-btn" data-category="tools">å·¥å…·</button>
            </div>
            
            <div class="code-options" id="codeOptions">
                <!-- å‹•æ…‹ç”Ÿæˆçš„é¸é …æŒ‰éˆ• -->
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <button class="action-btn reset-btn" id="changeQuestionBtn">æ›ä¸€é¡Œ</button>
        <button class="action-btn new-group-btn" id="newGroupBtn">æ–°è™•ç†çµ„</button>
        <button class="action-btn run-btn" id="runCode">
            <span class="emoji">âš¡</span> åŸ·è¡Œæ–™ç†
        </button>
    </div>
    
    <!-- çµæœé¡¯ç¤ºå€ -->
    <div class="result-container" id="resultContainer">
        <div class="score-display" id="scoreDisplay">ç›¸ä¼¼åº¦è©•åˆ†: -</div>
        <div class="recipe-sentence" id="recipeResult">çµ„åˆä½ çš„æ–™ç†ç¨‹å¼ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒåŸ·è¡Œæ–™ç†ã€ä¾†çœ‹çœ‹çµæœï¼</div>
        <div id="aiPrompt"></div>
        <button class="action-btn" id="copyBtn" style="display:none; width:100%; margin-top:10px;">è¤‡è£½åˆ†æçµæœ</button>
    </div>

    <script>
        const recipeQuestions = [
            {
                "title": "åå¸æœé†¬",
                "description": "æŒ‘æˆ°ï¼šè£½ä½œä¸€ä»½é£½è¶³æ„Ÿçš„æ‡¶äººå¿«é€Ÿç‡Ÿé¤Šæ—©é¤ï¼Œ2 åˆ†é˜æå®šã€‚",
                "ingredients": ["åå¸", "æœé†¬"],
                "actions": ["çƒ¤"],
                "seasonings": [],
                "tools": ["éºµåŒ…æ©Ÿ"],
                "tips": "åå¸å¯æ–¼è¶…å¸‚è³¼è²·ï¼Œä¿è³ªæœŸè¼ƒçŸ­ã€‚ç”¨é¤å·¾ç´™åŒ…è‘—å¯ä»¥é‚Šèµ°é‚Šåƒã€‚"
            },
            {
                "title": "å¾®æ³¢çˆè·åŒ…è›‹",
                "description": "æŒ‘æˆ°ï¼šè£½ä½œä¸€é“ç°¡å–®æ˜“åšä¸”å¯Œå«è›‹ç™½è³ªçš„èœé¤šï¼Œ120ç§’å…§å³å¯å®Œæˆã€‚",
                "ingredients": ["é›è›‹", "é£²ç”¨æ°´"],
                "actions": ["å¾®æ³¢", "åŠ é¹½"],
                "seasonings": ["èŠéº»æ²¹"],
                "tools": ["å¾®æ³¢çˆ", "å°ç¢—"],
                "tips": "ç‚ºé¿å…åŠ ç†±æ™‚è›‹é»ƒæ¿ºå‡ºï¼Œå¯ä»¥åœ¨ç¢—ä¸ŠåŠ è“‹ã€‚ç”¨ç­·å­åœ¨è›‹é»ƒä¸Šæˆ³å¹¾å€‹æ´æ˜¯é—œéµï¼"
            },
            {
                "title": "ç‚’é’èœ",
                "description": "æŒ‘æˆ°ï¼šè£½ä½œä¸€ä»½ç°¡å–®çš„ç‚’é’èœï¼Œä¿æŒè”¬èœçš„è„†åº¦å’Œç‡Ÿé¤Šã€‚",
                "ingredients": ["é«˜éº—èœ", "å¤§è’œ"],
                "actions": ["åˆ‡", "ç‚’", "åŠ é¹½"],
                "seasonings": [],
                "tools": ["ç‚’é‹"],
                "tips": "ç«å€™è¦å¤§ï¼Œæ™‚é–“è¦çŸ­ï¼Œé€™æ¨£æ‰èƒ½ä¿æŒè”¬èœçš„è„†åº¦ã€‚"
            },
            {
                "title": "å¾®æ³¢çˆè›‹ç³•çš„åšæ³•",
                "description": "å¾®æ³¢çˆã€Œå®ã€è›‹ç³•ï¼Œå¤§ç´„éœ€è¦ 2 åˆ†é˜å°±èƒ½æå®šï¼åˆå­¸è€…æ‰€éœ€æ™‚é–“é è¨ˆå»¶é•·è‡³ 20 åˆ†é˜ã€‚",
                "ingredients": ["é›è›‹", "éºµç²‰", "é»ƒæ²¹", "æ³¡æ‰“ç²‰", "å’–å•¡ç²‰", "å·§å…‹åŠ›", "éº¥ç‰‡", "ç‰›å¥¶", "å …æœ", "é¤…ä¹¾å±‘", "é¦™è•‰"],
                "actions": ["å¾®æ³¢", "åŠ ç³–", "åŠ é¹½"],
                "tools": ["å¾®æ³¢çˆ", "å¾®æ³¢å®¹å™¨"],
                "tips": "æ³¡æ‰“ç²‰å¯è®“è›‹ç³•æ›´è“¬é¬†ã€‚è‹¥åŠ å…¥ç‰›å¥¶ç­‰æ¶²é«”é£Ÿæï¼Œéœ€å°‘é‡å¤šæ¬¡æ·»åŠ ï¼Œç¢ºä¿éºµç³Šèƒ½ç¶­æŒç¨ ç‹€ã€‚æ‰€æœ‰é£Ÿæçš„ç¸½é‡ä¸æ‡‰è¶…éå®¹å™¨çš„3/4ï¼Œä»¥å…åŠ ç†±æ™‚æº¢å‡ºã€‚"
            },
            {
                "title": "ç‰›å¥¶ç‡•éº¥çš„åšæ³•",
                "description": "é«˜è›‹ç™½ã€å¯Œå«ç©€ç‰©çº–ç¶­ã€å…·é£½è¶³æ„Ÿçš„æ‡¶äººå¿«é€Ÿç‡Ÿé¤Šæ—©é¤ï¼Œ3 åˆ†é˜æå®šã€‚",
                "ingredients": ["ç‰›å¥¶", "ç‡•éº¥", "é›è›‹", "æ°´", "æ°´æœ", "è”¬èœ", "è˜‡æ‰“é¤…ä¹¾"],
                "actions": ["ç…®", "ç…", "åŠ æ²¹", "åŠ æ¤’é¹½"],
                "tools": ["æ—©é¤æ¯", "é‹", "å¾®æ³¢çˆ"],
                "tips": "å¯å°‡ä¸€èˆ¬ç‡•éº¥æ›¿æ›ç‚ºå¿«ç…®ç‡•éº¥ï¼Œèˆ‡ç‰›å¥¶æ··åˆå¾Œæ”¾å…¥å¾®æ³¢çˆä¸­ç«åŠ ç†±4åˆ†é˜ã€‚æœ¬é¤é»æ­é…æ°´æœã€è”¬èœæˆ–è˜‡æ‰“é¤…ä¹¾é¢¨å‘³æ›´ä½³ã€‚"
            },
            {
                "title": "ç•ªèŒ„ç‚’è›‹",
                "description": "ç¶“å…¸å®¶å¸¸èœï¼Œé…¸ç”œé–‹èƒƒï¼Œç‡Ÿé¤Šè±å¯Œï¼Œæ˜¯ç±³é£¯çš„çµ•ä½³æ­æª”ã€‚",
                "ingredients": ["é›è›‹", "ç•ªèŒ„", "è”¥"],
                "actions": ["ç‚’", "åŠ æ²¹", "åŠ é¹½", "åŠ ç³–"],
                "tools": ["ç‚’é‹", "ç¢—", "é‹éŸ"],
                "tips": "å–œæ­¡æ¹¯æ±å¤šä¸€é»å¯ä»¥åœ¨ç‚’ç•ªèŒ„æ™‚åŠ å…¥å°‘é‡æ°´ã€‚åŠ ä¸€é»ç³–å¯ä»¥å¹³è¡¡ç•ªèŒ„çš„é…¸å‘³ï¼Œè®“é¢¨å‘³æ›´æœ‰å±¤æ¬¡ã€‚"
            },
            {
                "title": "å¯æ¨‚é›ç¿…",
                "description": "é¹¹ç”œäº¤ç¹”çš„é›¶å¤±æ•—æ–™ç†ï¼Œè‰²æ¾¤ç´…äº®èª˜äººï¼Œè‚‰è³ªé®®å«©ï¼Œé€£å»šæˆ¿æ–°æ‰‹ä¹Ÿèƒ½è¼•é¬†é§•é¦­ã€‚",
                "ingredients": ["é›ç¿…", "è–‘", "è”¥"],
                "actions": ["ç…", "ç‡œ", "åŠ å¯æ¨‚", "åŠ é†¬æ²¹", "åŠ æ–™é…’", "åŠ æ²¹"],
                "tools": ["å¹³åº•é‹", "é‹éŸ"],
                "tips": "é›ç¿…å…ˆç…éå¯ä»¥è®“è¡¨çš®æ›´é¦™é…¥ã€‚æ”¶æ±æ™‚è¦ä¸åœç¿»å‹•ï¼Œé¿å…é†¬æ±ç‡’ç„¦é»é‹ã€‚å¯æ¨‚çš„ç”œåº¦å·²è¶³å¤ ï¼Œé€šå¸¸ä¸éœ€é¡å¤–åŠ ç³–ã€‚"
            },
            {
                "title": "å®¶å¸¸é›è›‹ç‚’é£¯",
                "description": "å¿«é€Ÿè§£æ±ºå‰©é£¯çš„æœ€ä½³æ–¹å¼ï¼Œç°¡å–®ç¾å‘³ï¼Œç²’ç²’åˆ†æ˜ï¼Œæ˜¯æ¯å€‹å®¶åº­å¿…å‚™çš„å¿«é€Ÿé¤é»ã€‚",
                "ingredients": ["éš”å¤œé£¯", "é›è›‹", "è”¥", "å†·å‡è”¬èœä¸"],
                "actions": ["ç‚’", "åŠ æ²¹", "åŠ é†¬æ²¹", "åŠ é¹½", "åŠ ç™½èƒ¡æ¤’ç²‰"],
                "tools": ["ç‚’é‹", "ç¢—", "é‹éŸ"],
                "tips": "ä½¿ç”¨éš”å¤œçš„å†·é£¯æ˜¯ç‚’é£¯ç²’ç²’åˆ†æ˜çš„é—œéµã€‚å¯ä¾å€‹äººå–œå¥½åŠ å…¥ç«è…¿ã€è¦ä»æˆ–è‚‰æœ«ç­‰é…æ–™ï¼Œè®“ç‚’é£¯æ›´è±å¯Œã€‚"
            }
        ];
        
        const codeLibrary = {
            ingredients: [
                { emoji: "ğŸ", name: "åå¸", type: "ingredient" }, { emoji: "ğŸ“", name: "æœé†¬", type: "ingredient" },
                { emoji: "ğŸ¥š", name: "é›è›‹", type: "ingredient" }, { emoji: "ğŸ’§", name: "é£²ç”¨æ°´", type: "ingredient" },
                { emoji: "ğŸ¥¬", name: "é«˜éº—èœ", type: "ingredient" }, { emoji: "ğŸ§„", name: "å¤§è’œ", type: "ingredient" },
                { emoji: "ğŸ”", name: "é›è‚‰", type: "ingredient" }, { emoji: "ğŸŸ", name: "é­šè‚‰", type: "ingredient" },
                { emoji: "ğŸŒ¾", name: "éºµç²‰", type: "ingredient" }, { emoji: "ğŸ§ˆ", name: "é»ƒæ²¹", type: "ingredient" },
                { emoji: "ğŸ¥¡", name: "æ³¡æ‰“ç²‰", type: "ingredient" }, { emoji: "â˜•", name: "å’–å•¡ç²‰", type: "ingredient" },
                { emoji: "ğŸ«", name: "å·§å…‹åŠ›", type: "ingredient" }, { emoji: "ğŸ¥£", name: "éº¥ç‰‡", type: "ingredient" },
                { emoji: "ğŸ¥›", name: "ç‰›å¥¶", type: "ingredient" }, { emoji: "ğŸ¥œ", name: "å …æœ", type: "ingredient" },
                { emoji: "ğŸª", name: "é¤…ä¹¾å±‘", type: "ingredient" }, { emoji: "ğŸŒ", name: "é¦™è•‰", type: "ingredient" },
                { emoji: "ğŸ¥£", name: "ç‡•éº¥", type: "ingredient" }, { emoji: "ğŸ’§", name: "æ°´", type: "ingredient" },
                { emoji: "ğŸ“", name: "æ°´æœ", type: "ingredient" }, { emoji: "ğŸ¥¬", name: "è”¬èœ", type: "ingredient" },
                { emoji: "ğŸ¥¨", name: "è˜‡æ‰“é¤…ä¹¾", type: "ingredient" }, { emoji: "ğŸ…", name: "ç•ªèŒ„", type: "ingredient" },
                { emoji: "ğŸ§…", name: "è”¥", type: "ingredient" }, { emoji: "ğŸ—", name: "é›ç¿…", type: "ingredient" },
                { emoji: "ğŸ«š", name: "è–‘", type: "ingredient" }, { emoji: "ğŸ¥¤", name: "å¯æ¨‚", type: "ingredient" },
                { emoji: "ğŸ¾", name: "æ–™é…’", type: "ingredient" }, { emoji: "ğŸš", name: "éš”å¤œé£¯", type: "ingredient" },
                { emoji: "ğŸ¥¦", name: "å†·å‡è”¬èœä¸", type: "ingredient" }
            ],
            actions: [
                { emoji: "ğŸ”ª", name: "åˆ‡", type: "action", requires: ["ingredient"], process: (state) => `åˆ‡å¥½çš„${state}` },
                { emoji: "ğŸ³", name: "ç‚’", type: "action", requires: ["ingredient", "tool"], process: (state, tool) => `ç”¨${tool}ç‚’éçš„${state}` },
                { emoji: "ğŸ”¥", name: "çƒ¤", type: "action", requires: ["ingredient", "tool"], process: (state, tool) => `ç”¨${tool}çƒ¤éçš„${state}` },
                { emoji: "â™¨ï¸", name: "å¾®æ³¢", type: "action", requires: ["ingredient", "tool"], process: (state, tool) => `ç”¨${tool}å¾®æ³¢éçš„${state}` },
                { emoji: "ğŸ§‚", name: "åŠ é¹½", type: "action", requires: ["ingredient"], process: (state) => `åŠ é¹½èª¿å‘³çš„${state}` },
                { emoji: "âš«", name: "åŠ é»‘èƒ¡æ¤’", type: "action", requires: ["ingredient"], process: (state) => `åŠ äº†é»‘èƒ¡æ¤’çš„${state}`},
                { emoji: "ğŸ’§", name: "åŠ èŠéº»æ²¹", type: "action", requires: ["ingredient"], process: (state) => `åŠ äº†èŠéº»æ²¹çš„${state}`},
                { emoji: "ğŸ¶", name: "åŠ é†¬æ²¹", type: "action", requires: ["ingredient"], process: (state) => `åŠ äº†é†¬æ²¹çš„${state}`},
                { emoji: "ğŸ¬", name: "åŠ ç³–", type: "action", requires: ["ingredient"], process: (state) => `åŠ ç³–èª¿å‘³çš„${state}`},
                { emoji: "ğŸ’§", name: "åŠ æ²¹", type: "action", requires: ["ingredient"], process: (state) => `åŠ æ²¹æ½¤é£¾çš„${state}`},
                { emoji: "ğŸŒ¶ï¸", name: "åŠ æ¤’é¹½", type: "action", requires: ["ingredient"], process: (state) => `åŠ äº†æ¤’é¹½çš„${state}`},
                { emoji: "ğŸ”¥", name: "ç…®", type: "action", requires: ["ingredient", "tool"], process: (state, tool) => `ç”¨${tool}ç…®ç†Ÿçš„${state}`},
                { emoji: "ğŸ³", name: "ç…", type: "action", requires: ["ingredient", "tool"], process: (state, tool) => `ç”¨${tool}ç…éçš„${state}`},
                { emoji: "ğŸ²", name: "ç‡œ", type: "action", requires: ["ingredient", "tool"], process: (state, tool) => `ç”¨${tool}ç‡œç…®çš„${state}`},
                { emoji: "ğŸ¥¤", name: "åŠ å¯æ¨‚", type: "action", requires: ["ingredient"], process: (state) => `ç”¨å¯æ¨‚æ»·è£½çš„${state}`},
                { emoji: "ğŸ¾", name: "åŠ æ–™é…’", type: "action", requires: ["ingredient"], process: (state) => `ç”¨æ–™é…’èª¿å‘³çš„${state}`},
                { emoji: "ğŸŒ¶ï¸", name: "åŠ ç™½èƒ¡æ¤’ç²‰", type: "action", requires: ["ingredient"], process: (state) => `æ’’ä¸Šç™½èƒ¡æ¤’ç²‰çš„${state}`}
            ],
            tools: [
                { emoji: "ğŸ³", name: "ç‚’é‹", type: "tool" }, { emoji: "â™¨ï¸", name: "å¾®æ³¢çˆ", type: "tool" },
                { emoji: "ğŸ", name: "éºµåŒ…æ©Ÿ", type: "tool" }, { emoji: "ğŸ¥£", name: "å°ç¢—", type: "tool" },
                { emoji: "âš—ï¸", name: "å¾®æ³¢å®¹å™¨", type: "tool" }, { emoji: "â˜•", name: "æ—©é¤æ¯", type: "tool" },
                { emoji: "ğŸ²", name: "é‹", type: "tool" }, { emoji: "ğŸ¥£", name: "ç¢—", type: "tool" },
                { emoji: "ğŸ³", name: "é‹éŸ", type: "tool" }, { emoji: "ğŸ³", name: "å¹³åº•é‹", type: "tool" }
            ]
        };

        // ç‹€æ…‹ç®¡ç†
        let currentQuestion = null;
        let currentGroup = 0;
        let groups = { 0: [] };
        let tempIngredients = []; // å„²å­˜çµ„åˆå‡ºçš„æ–°é£Ÿæ

        // DOMè¼‰å…¥å¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initPalette();
            showRandomQuestion();

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    filterOptions(btn.dataset.category);
                });
            });

            document.getElementById('changeQuestionBtn').addEventListener('click', showRandomQuestion);
            document.getElementById('newGroupBtn').addEventListener('click', addNewGroup);
            document.getElementById('runCode').addEventListener('click', executeRecipe);
            document.getElementById('copyBtn').addEventListener('click', copyAnalysisResult);
        });

        // åˆå§‹åŒ–æŒ‡ä»¤é¢æ¿
        function initPalette() {
            const container = document.getElementById('codeOptions');
            container.innerHTML = '';
            
            const allOptions = [];
            // å°‡æ°¸ä¹…é£Ÿæå’Œè‡¨æ™‚é£Ÿæåˆä½µ
            const currentIngredients = [...codeLibrary.ingredients];

            const libraryWithTempIngredients = {
                ...codeLibrary,
                ingredients: currentIngredients,
                combined: tempIngredients // æ–°å¢ä¸€å€‹çµ¦çµ„åˆæŒ‰éˆ•ç”¨çš„åˆ†é¡
            };
            
            for (const categoryKey in libraryWithTempIngredients) {
                if(categoryKey === 'seasonings') continue; // èª¿å‘³æ–™å·²åˆä½µåˆ°æ“ä½œ
                libraryWithTempIngredients[categoryKey].forEach(item => {
                    const newItem = { ...item, category: categoryKey };
                    allOptions.push(newItem);
                });
            }
            
            allOptions.sort(() => Math.random() - 0.5);
            
            allOptions.forEach(item => {
                const btn = document.createElement('button');
                btn.className = 'code-option';
                btn.dataset.category = item.category;
                // çµ„åˆå‡ºä¾†çš„é£Ÿæï¼Œä¹Ÿæ­¸é¡åˆ°é£Ÿæï¼Œä»¥ä¾¿ require åˆ¤æ–·
                if (item.isCombinedResult) {
                    btn.dataset.type = 'ingredient';
                    btn.dataset.isCombined = 'true';
                } else {
                    btn.dataset.type = item.type;
                }
                btn.id = `option-${item.name.replace(/\s/g, '-')}`;
                btn.innerHTML = `<span class="emoji">${item.emoji}</span> ${item.name}`;
                btn.addEventListener('click', () => addToCodeStack(item));
                container.appendChild(btn);
            });
            updatePaletteState(); // åˆå§‹åŒ–å¾Œæ›´æ–°ä¸€æ¬¡é¢æ¿ç‹€æ…‹
        }

        // åˆ†é¡ç¯©é¸
        function filterOptions(category) {
            document.querySelectorAll('.code-option').forEach(option => {
                const optionCategory = option.dataset.category;
                const isCombined = option.dataset.isCombined === 'true';

                let show = false;
                if (category === 'all') {
                    show = true;
                } else if (category === 'combined') {
                    if (isCombined) show = true;
                } else if (category === 'ingredients') {
                    if (optionCategory === 'ingredients' && !isCombined) show = true;
                } else {
                    if (optionCategory === category) show = true;
                }

                option.style.display = show ? 'flex' : 'none';
            });
        }

        // æ·»åŠ åˆ°ç¨‹å¼ç¢¼å †ç–Š
        function addToCodeStack(item) {
            document.getElementById('initialMessage')?.remove();
            
            if (!groups[currentGroup]) {
                groups[currentGroup] = [];
            }

            const newItem = { ...item, id: Date.now() + Math.random().toString(36).substr(2, 5) };
            groups[currentGroup].push(newItem);
            
            updateCodePreview();
            updatePaletteState();
        }

        // æ›´æ–°ç¨‹å¼ç¢¼é è¦½
        function updateCodePreview() {
            const preview = document.getElementById('codePreview');
            preview.innerHTML = '';
            
            if (Object.values(groups).every(g => g.length === 0)) {
                preview.innerHTML = '<div class="code-line" id="initialMessage">// é»æ“Šå³å´æŒ‡ä»¤é–‹å§‹çµ„åˆ...</div>';
                return;
            }
            
            for (const groupId in groups) {
                const group = groups[groupId];
                if (group.length === 0) continue;
                
                const groupDiv = document.createElement('div');
                groupDiv.className = 'code-line-group';
                
                group.forEach(item => {
                    const lineDiv = document.createElement('div');
                    lineDiv.className = 'code-line';
                    lineDiv.dataset.type = item.type;
                    lineDiv.innerHTML = `
                        <span class="emoji">${item.emoji}</span> 
                        <span>${item.name}</span>
                        <button class="delete-btn">Ã—</button>
                    `;
                    lineDiv.querySelector('.delete-btn').addEventListener('click', (e) => {
                        e.stopPropagation();
                        removeFromCodeStack(item.id, groupId);
                    });
                    groupDiv.appendChild(lineDiv);
                });
                
                const currentState = getGroupState(group);
                if(currentState) {
                    const stateDiv = document.createElement('div');
                    stateDiv.className = 'code-line';
                    stateDiv.dataset.type = 'processed';
                    stateDiv.innerHTML = `<span>â¡ï¸ ç‹€æ…‹: ${currentState}</span>`;
                    groupDiv.appendChild(stateDiv);

                    // æ–°å¢"çµ„åˆ"æŒ‰éˆ•
                    const combineBtn = document.createElement('button');
                    combineBtn.className = 'combine-btn';
                    combineBtn.textContent = 'çµ„åˆ';
                    combineBtn.onclick = () => combineToIngredient(currentState, groupId);
                    groupDiv.appendChild(combineBtn);
                }

                preview.appendChild(groupDiv);
            }
        }
        
        // å³æ™‚è¨ˆç®—å–®å€‹çµ„çš„ç‹€æ…‹
        function getGroupState(group) {
            let state = null;
            let ingredientsInState = [];
            const toolsInState = [];

            for (const item of group) {
                if (item.type === 'ingredient') {
                    ingredientsInState.push(item.name);
                } else if (item.type === 'tool') {
                    toolsInState.push(item.name);
                } else if (item.type === 'action' && item.process && ingredientsInState.length > 0) {
                    let combinedState = ingredientsInState.join('å’Œ');
                    if (item.requires.includes('tool')) {
                        const tool = toolsInState.pop() || 'æŸå€‹å·¥å…·';
                        state = item.process(combinedState, tool);
                    } else {
                        state = item.process(combinedState);
                    }
                    ingredientsInState = [state]; // The result becomes the new single ingredient for the next step
                } else {
                    state = ingredientsInState.join('å’Œ');
                }
            }
            return state || ingredientsInState.join('å’Œ') || null;
        }


        // å¾å †ç–Šä¸­ç§»é™¤é …ç›®
        function removeFromCodeStack(id, groupId) {
            groups[groupId] = groups[groupId].filter(item => item.id !== id);
            // å¦‚æœä¸€å€‹çµ„ç©ºäº†ï¼Œå°±æŠŠå®ƒåˆªæ‰ï¼Œé™¤éæ˜¯æœ€å¾Œä¸€å€‹é è¨­çµ„
            if (groups[groupId].length === 0 && groupId != 0) {
                delete groups[groupId];
            }
            updateCodePreview();
            updatePaletteState();
        }

        // æ·»åŠ æ–°è™•ç†çµ„
        function addNewGroup() {
            if (groups[currentGroup] && groups[currentGroup].length === 0) {
                return;
            }
            currentGroup = Date.now();
            groups[currentGroup] = [];
            updateCodePreview(); // æ›´æ–°é è¦½ä»¥é¡¯ç¤ºæ–°çµ„çš„ç©ºé–“
            updatePaletteState();
        }

        // éš¨æ©Ÿé¸æ“‡é¡Œç›®
        function showRandomQuestion() {
            currentQuestion = recipeQuestions[Math.floor(Math.random() * recipeQuestions.length)];
            document.getElementById('recipeDescription').textContent = currentQuestion.description;
            document.getElementById('recipeTips').textContent = `å°è²¼å£«ï¼š${currentQuestion.tips}`;
            resetAll();
        }

        // é‡ç½®æ‰€æœ‰ç‹€æ…‹
        function resetAll() {
            currentGroup = 0;
            groups = { 0: [] };
            tempIngredients = []; // æ¸…ç©ºè‡¨æ™‚é£Ÿæ
            initPalette(); // é‡æ–°åˆå§‹åŒ–é¢æ¿
            updateCodePreview();
            document.getElementById('scoreDisplay').textContent = 'ç›¸ä¼¼åº¦è©•åˆ†: -';
            document.getElementById('recipeResult').textContent = 'çµ„åˆä½ çš„æ–™ç†ç¨‹å¼ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒåŸ·è¡Œæ–™ç†ã€ä¾†çœ‹çœ‹çµæœï¼';
            document.getElementById('aiPrompt').innerHTML = '';
            document.getElementById('copyBtn').style.display = 'none';
        }

        // åŸ·è¡Œæ–™ç†åˆ†æ
        function executeRecipe() {
            const finalStates = Object.values(groups).map(getGroupState).filter(s => s);
            const score = calculateScore();
            document.getElementById('scoreDisplay').textContent = `ç›¸ä¼¼åº¦è©•åˆ†: ${score}/100`;
            
            const result = generateResult(finalStates, score);
            document.getElementById('recipeResult').innerHTML = result.recipe;
            document.getElementById('aiPrompt').innerHTML = result.analysis;
            document.getElementById('copyBtn').style.display = 'block';
        }

        // **æ–°å¢**ï¼šæ™ºæ…§æ›´æ–°æŒ‡ä»¤é¢æ¿ç‹€æ…‹
        function updatePaletteState() {
            const currentGroupItems = groups[currentGroup] || [];
            const hasIngredient = currentGroupItems.some(i => i.type === 'ingredient' || i.isCombinedResult);
            const hasTool = currentGroupItems.some(i => i.type === 'tool');

            document.querySelectorAll('.code-option').forEach(btn => {
                const category = btn.dataset.category;
                let disabled = false;

                if (category === 'actions') {
                    if (!hasIngredient) {
                        disabled = true; // æ²’æœ‰é£Ÿæï¼Œä¸èƒ½æ“ä½œ
                    } else {
                        // æª¢æŸ¥ç‰¹å®šæ“ä½œçš„éœ€æ±‚
                        const actionName = btn.textContent.trim().split(' ').slice(1).join(' ');
                        const action = codeLibrary.actions.find(a => a.name === actionName);
                        if (action && action.requires.includes('tool') && !hasTool) {
                            disabled = true; // éœ€è¦å·¥å…·ä½†æ²’æœ‰å·¥å…·
                        }
                    }
                } else if (category === 'ingredients' || category === 'combined') {
                    if (hasIngredient) {
                        disabled = true;
                    }
                }

                btn.disabled = disabled;
            });
        }
        
        // **æ–°å¢**ï¼šå°‡çµ„åˆçµæœè®Šæˆæ–°é£Ÿæ
        function combineToIngredient(state, groupId) {
            if (!state || tempIngredients.some(ing => ing.name === state)) return;

            const newIngredient = {
                emoji: 'ğŸ“¦',
                name: state,
                type: 'ingredient',
                isCombinedResult: true // æ¨™è¨˜ç‚ºçµ„åˆçµæœ
            };
            tempIngredients.push(newIngredient);

            // æ¸…ç©ºèˆŠçš„group
            delete groups[groupId];

            // å¦‚æœè¢«çµ„åˆæ‰çš„æ˜¯ç•¶å‰æ“ä½œçš„çµ„ï¼Œå‰‡å»ºç«‹ä¸€å€‹æ–°çµ„
            if (currentGroup == groupId) {
                addNewGroup();
            }

            initPalette(); // é‡å»ºæŒ‡ä»¤é¢æ¿ä»¥åŒ…å«æ–°é£Ÿæ
            updateCodePreview();
        }

        // è¨ˆç®—ç›¸ä¼¼åº¦åˆ†æ•¸
        function calculateScore() {
            let score = 0;
            const userSelections = { ingredients: new Set(), actions: new Set(), tools: new Set() };
            
            for (const groupId in groups) {
                if (!Array.isArray(groups[groupId])) continue;
                groups[groupId].forEach(item => {
                    if (item.category === 'ingredients' && !item.isCombinedResult) {
                        userSelections.ingredients.add(item.name);
                    } else if (userSelections[item.category]) {
                        userSelections[item.category].add(item.name);
                    }
                });
            }

            const answer = {
                ingredients: new Set(currentQuestion.ingredients),
                actions: new Set([...(currentQuestion.actions || []), ...(currentQuestion.seasonings || [])]),
                tools: new Set(currentQuestion.tools)
            };
            
            const weights = { ingredients: 40, actions: 40, tools: 20 }; // èª¿æ•´æ¬Šé‡
            
            for (const category in userSelections) {
                const userItems = userSelections[category];
                const answerItems = answer[category];
                if (!answerItems || answerItems.size === 0) {
                    score += userItems.size === 0 ? (weights[category] || 0) : 0;
                    continue;
                }
                let correctMatches = 0;
                userItems.forEach(item => { if (answerItems.has(item)) correctMatches++; });
                score += Math.min(weights[category], (correctMatches / answerItems.size) * weights[category]);
            }
            
            return Math.min(100, Math.round(score));
        }

        // ç”Ÿæˆçµæœ
        function generateResult(finalStates, score) {
            let recipe = `<h2>æ‚¨çš„æ–™ç†æµç¨‹</h2>`;
            recipe += Object.keys(groups).map((groupId, index) => {
                if (!Array.isArray(groups[groupId]) || groups[groupId].length === 0) return '';
                return `<h3>è™•ç†çµ„ ${index + 1} â¡ï¸ ${getGroupState(groups[groupId]) || 'æœªå®Œæˆ'}</h3>` +
                    groups[groupId].map(item => `<div>${item.emoji} ${item.name}</div>`).join('');
            }).join('');
            
            let analysis = `<h3>âœ… ç›¸ä¼¼åº¦è©•åˆ†: ${score}/100</h3>`;
            analysis += `<p>${getOverallFeedback(score)}</p>`;
            analysis += `<h3>âœ… å·®ç•°åˆ†æ:</h3>`;
            analysis += `<table class="diff-table">
                <tr><th>é …ç›®</th><th>æ‚¨çš„é¸æ“‡</th><th>æ­£ç¢ºç­”æ¡ˆ</th><th>åˆ†æ</th></tr>
                ${generateDiffTableRows('é£Ÿæ', 'ingredients', currentQuestion.ingredients)}
                ${generateDiffTableRows('æ“ä½œèˆ‡èª¿å‘³', 'actions', [...currentQuestion.actions, ...currentQuestion.seasonings])}
                ${generateDiffTableRows('å·¥å…·', 'tools', currentQuestion.tools)}
            </table>`;
            analysis += `<h3>âœ… æ”¹é€²å»ºè­°:</h3><p>${generateImprovementSuggestions()}</p>`;
            analysis += `<h3>âœ… æˆå“é æ¸¬:</h3><p>${predictOutcome(finalStates)}</p>`;
            analysis += `<h3>âœ… å‰µæ„è©•åƒ¹:</h3><p>${getCreativeFeedback(score)}</p>`;
            
            return { recipe, analysis };
        }

        // ç”Ÿæˆå·®ç•°è¡¨æ ¼è¡Œ
        function generateDiffTableRows(categoryName, categoryKey, correctItemsSet) {
            const userItems = new Set();
            for (const groupId in groups) {
                if (!Array.isArray(groups[groupId])) continue;
                groups[groupId].forEach(item => {
                    if (item.category === categoryKey && !item.isCombinedResult) {
                        userItems.add(item.name);
                    }
                });
            }
            const correctItems = new Set(correctItemsSet);
            const allItems = [...new Set([...correctItems, ...userItems])];
            
            if (allItems.length === 0 && correctItems.size === 0) {
                 return `<tr><td>${categoryName}</td><td>âœ“ (ç„¡)</td><td>âœ“ (ç„¡)</td><td>æ­£ç¢º</td></tr>`;
            }
            
            return allItems.map(item => `
                <tr>
                    <td>${item}</td>
                    <td>${userItems.has(item) ? 'âœ“' : 'âœ—'}</td>
                    <td>${correctItems.has(item) ? 'âœ“' : 'âœ—'}</td>
                    <td>${getDiffAnalysis(item, correctItems.has(item), userItems.has(item))}</td>
                </tr>
            `).join('');
        }

        // å·®ç•°åˆ†æ
        function getDiffAnalysis(item, isCorrect, isUser) {
            if (isCorrect && isUser) return "æ­£ç¢ºé¸æ“‡ï¼";
            if (!isCorrect && isUser) return `å¤šé¤˜çš„é¸æ“‡ï¼Œæ­¤é£Ÿè­œä¸éœ€è¦ã€Œ${item}ã€ã€‚`;
            if (isCorrect && !isUser) return `ç¼ºå°‘å¿…è¦çš„ã€Œ${item}ã€ã€‚`;
            return "-";
        }

        // æ–°å¢ï¼šç¸½é«”è©•åƒ¹
        function getOverallFeedback(score) {
            if (score >= 80) return "æ‚¨çš„æ–™ç†èˆ‡æ¨™æº–ç­”æ¡ˆéå¸¸æ¥è¿‘ï¼Œå®Œç¾æŒæ¡åŸºæœ¬æŠ€å·§ï¼";
            if (score >= 50) return "é›–ç„¶æœ‰äº›å·®ç•°ï¼Œä½†é€™å¯èƒ½æˆç‚ºæ‚¨ç¨ç‰¹çš„æ–™ç†é¢¨æ ¼ï¼";
            
            const { missingKeyIngredient, missingKeyAction } = findKeyMistakes();
            if (missingKeyIngredient) {
                return `ä¸»è¦å¤±èª¤ï¼šæ‚¨çš„æ–™ç†ç¼ºå°‘äº†é—œéµé£Ÿæã€Œ${missingKeyIngredient}ã€ï¼Œå°è‡´é¢¨å‘³å’ŒåŸºç¤å®Œå…¨ä¸åŒã€‚`;
            }
            if (missingKeyAction) {
                return `ä¸»è¦å¤±èª¤ï¼šæ‚¨çš„æ–™ç†ç¼ºå°‘äº†æ ¸å¿ƒæ­¥é©Ÿã€Œ${missingKeyAction}ã€ï¼Œé€™æ˜¯é€™é“èœçš„éˆé­‚æ‰€åœ¨ã€‚`;
            }

            return "é€™æ˜¯ä¸€å€‹æœ‰è¶£çš„å˜—è©¦ï¼Œä½†ä¼¼ä¹åé›¢äº†æŒ‘æˆ°ç›®æ¨™ã€‚è©¦è‘—æ›´è²¼è¿‘æç¤ºä¾†æ“ä½œçœ‹çœ‹ï¼Ÿ";
        }

        // æ–°å¢ï¼šæ‰¾å‡ºé—œéµéŒ¯èª¤
        function findKeyMistakes() {
            const userIngredients = new Set();
            const userActions = new Set();
            for (const groupId in groups) {
                if (!Array.isArray(groups[groupId])) continue;
                groups[groupId].forEach(item => {
                    if (item.category === 'ingredients' && !item.isCombinedResult) {
                        userIngredients.add(item.name);
                    } else if (item.category === 'actions') {
                        userActions.add(item.name);
                    }
                });
            }
            
            const neededIngredients = new Set(currentQuestion.ingredients);
            const neededActions = new Set([...(currentQuestion.actions || []), ...(currentQuestion.seasonings || [])]);

            const firstMissingIngredient = [...neededIngredients].find(i => !userIngredients.has(i));
            const firstMissingAction = [...neededActions].find(a => !userActions.has(a));

            return { missingKeyIngredient: firstMissingIngredient, missingKeyAction: firstMissingAction };
        }

        // ç”Ÿæˆæ”¹é€²å»ºè­°
        function generateImprovementSuggestions() {
            let suggestions = [];
            const userActions = new Set(Object.values(groups).flat().filter(i => i.category === 'actions').map(i => i.name));
            const userIngredients = new Set(Object.values(groups).flat().filter(i => i.category === 'ingredients' && !i.isCombinedResult).map(i => i.name));
            
            const neededActions = new Set([...(currentQuestion.actions || []), ...(currentQuestion.seasonings || [])]);
            const neededIngredients = new Set(currentQuestion.ingredients);

            neededActions.forEach(item => {
                if (!userActions.has(item)) {
                    suggestions.push(`å»ºè­°åŠ å…¥æ“ä½œã€Œ${item}ã€ã€‚`);
                }
            });
            neededIngredients.forEach(item => {
                if (!userIngredients.has(item)) {
                    suggestions.push(`å»ºè­°åŠ å…¥é£Ÿæã€Œ${item}ã€ã€‚`);
                }
            });

            return suggestions.length > 0 ? suggestions.join(' ') : "æ‚¨çš„æ­¥é©Ÿå·²ç¶“ç›¸ç•¶å®Œå–„ï¼";
        }

        // é æ¸¬æˆå“
        function predictOutcome(finalStates) {
            if (finalStates.length === 0) return "ç„¡æ³•é æ¸¬æˆå“ã€‚";
            return `æ ¹æ“šæ‚¨çš„æ­¥é©Ÿï¼Œæœ€çµ‚æˆå“å¯èƒ½æ˜¯ï¼š${finalStates.join(' å’Œ ')} çš„æ··åˆç‰©ã€‚`;
        }

        // å‰µæ„è©•åƒ¹
        function getCreativeFeedback(score) {
            if (score > 80) return "æ‚¨çš„æ–™ç†èˆ‡æ¨™æº–ç­”æ¡ˆéå¸¸æ¥è¿‘ï¼Œå®Œç¾æŒæ¡åŸºæœ¬æŠ€å·§ï¼";
            if (score > 50) return "é›–ç„¶æœ‰äº›å·®ç•°ï¼Œä½†é€™å¯èƒ½æˆç‚ºæ‚¨ç¨ç‰¹çš„æ–™ç†é¢¨æ ¼ï¼";
            return "é€™æ˜¯ä¸€å€‹å®Œå…¨å‰µæ–°çš„æ–™ç†çµ„åˆï¼Œèªªä¸å®šæœƒæ„å¤–åœ°ç¾å‘³ï¼";
        }

        // è¤‡è£½åˆ†æçµæœ
        function copyAnalysisResult() {
            const textToCopy = document.getElementById('aiPrompt').innerText;
            navigator.clipboard.writeText(textToCopy).then(() => {
                document.getElementById('copyBtn').textContent = 'å·²è¤‡è£½ï¼';
                setTimeout(() => { document.getElementById('copyBtn').textContent = 'è¤‡è£½åˆ†æçµæœ'; }, 2000);
            });
        }
    </script>
</body>
</html>